
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Lutris desktop client in Python / PyGObject.">
      
      
      
        <link rel="canonical" href="https://lutris.github.io/lutris/reference/lutris/installer/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>Index - Lutris</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lutris.installer" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Lutris" class="md-header__button md-logo" aria-label="Lutris" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Lutris
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/lutris/lutris/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lutris/lutris
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../wiki/Home/" class="md-tabs__link">
        Wiki
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Reference
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../contributing/" class="md-tabs__link">
        Development
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Lutris" class="md-nav__button md-logo" aria-label="Lutris" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Lutris
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/lutris/lutris/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lutris/lutris
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../credits/" class="md-nav__link">
        Credits
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Wiki
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Wiki" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Wiki
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../wiki/Home/" class="md-nav__link">
        Home
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/Apitracing/" class="md-nav__link">
        Apitracing a game
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/Battle.Net/" class="md-nav__link">
        Battle.Net
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/HowToDXVK/" class="md-nav__link">
        What is DXVK?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/HowToEsync/" class="md-nav__link">
        What is Esync?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/InstallingDrivers/" class="md-nav__link">
        InstallingDrivers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/LutrisRuntime/" class="md-nav__link">
        LutrisRuntime
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/Origin/" class="md-nav__link">
        Origin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/Overwatch/" class="md-nav__link">
        Overwatch on Linux (Wine)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/Performance-Tweaks/" class="md-nav__link">
        Performance Tweaks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/PressureVesselResearch/" class="md-nav__link">
        Pressure Vessel Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/ProvidingLogs%26SystemInfo/" class="md-nav__link">
        What we need to help you (TLDR):
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/RetroArch/" class="md-nav__link">
        RetroArch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/WineBuilds/" class="md-nav__link">
        Wine Builds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/WineDependencies/" class="md-nav__link">
        WineDependencies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/WorldOfWarcraft/" class="md-nav__link">
        World of Warcraft
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lutris_docs/titanfall-2/" class="md-nav__link">
        Titanfall 2 on Linux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          lutris
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="lutris" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          lutris
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        api
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cache/" class="md-nav__link">
        cache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../command/" class="md-nav__link">
        command
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        config
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_6" type="checkbox" id="__nav_3_1_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_6">
          database
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="database" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_6">
          <span class="md-nav__icon md-icon"></span>
          database
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../database/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../database/categories/" class="md-nav__link">
        categories
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../database/games/" class="md-nav__link">
        games
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../database/schema/" class="md-nav__link">
        schema
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../database/services/" class="md-nav__link">
        services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../database/sources/" class="md-nav__link">
        sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../database/sql/" class="md-nav__link">
        sql
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../discord/" class="md-nav__link">
        discord
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">
        exceptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../game/" class="md-nav__link">
        game
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../game_actions/" class="md-nav__link">
        game_actions
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11" type="checkbox" id="__nav_3_1_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_11">
          gui
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="gui" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_11">
          <span class="md-nav__icon md-icon"></span>
          gui
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/addgameswindow/" class="md-nav__link">
        addgameswindow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/application/" class="md-nav__link">
        application
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_4" type="checkbox" id="__nav_3_1_11_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_11_4">
          config
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="config" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_11_4">
          <span class="md-nav__icon md-icon"></span>
          config
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/add_game/" class="md-nav__link">
        add_game
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/base_config_box/" class="md-nav__link">
        base_config_box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/boxes/" class="md-nav__link">
        boxes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/common/" class="md-nav__link">
        common
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/edit_game/" class="md-nav__link">
        edit_game
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/preferences_box/" class="md-nav__link">
        preferences_box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/preferences_dialog/" class="md-nav__link">
        preferences_dialog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/runner/" class="md-nav__link">
        runner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/runner_box/" class="md-nav__link">
        runner_box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/runners_box/" class="md-nav__link">
        runners_box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/services_box/" class="md-nav__link">
        services_box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/config/sysinfo_box/" class="md-nav__link">
        sysinfo_box
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_5" type="checkbox" id="__nav_3_1_11_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_11_5">
          dialogs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="dialogs" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_11_5">
          <span class="md-nav__icon md-icon"></span>
          dialogs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/dialogs/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/dialogs/cache/" class="md-nav__link">
        cache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/dialogs/download/" class="md-nav__link">
        download
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/dialogs/issue/" class="md-nav__link">
        issue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/dialogs/log/" class="md-nav__link">
        log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/dialogs/runner_install/" class="md-nav__link">
        runner_install
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/dialogs/uninstall_game/" class="md-nav__link">
        uninstall_game
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/dialogs/webconnect_dialog/" class="md-nav__link">
        webconnect_dialog
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_6" type="checkbox" id="__nav_3_1_11_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_11_6">
          installer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="installer" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_11_6">
          <span class="md-nav__icon md-icon"></span>
          installer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/installer/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/installer/file_box/" class="md-nav__link">
        file_box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/installer/files_box/" class="md-nav__link">
        files_box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/installer/script_box/" class="md-nav__link">
        script_box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/installer/script_picker/" class="md-nav__link">
        script_picker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/installer/widgets/" class="md-nav__link">
        widgets
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/installerwindow/" class="md-nav__link">
        installerwindow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/lutriswindow/" class="md-nav__link">
        lutriswindow
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_9" type="checkbox" id="__nav_3_1_11_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_11_9">
          views
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="views" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_11_9">
          <span class="md-nav__icon md-icon"></span>
          views
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/views/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/views/base/" class="md-nav__link">
        base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/views/grid/" class="md-nav__link">
        grid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/views/list/" class="md-nav__link">
        list
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/views/media_loader/" class="md-nav__link">
        media_loader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/views/store/" class="md-nav__link">
        store
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/views/store_item/" class="md-nav__link">
        store_item
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_11_10" type="checkbox" id="__nav_3_1_11_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_11_10">
          widgets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="widgets" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_11_10">
          <span class="md-nav__icon md-icon"></span>
          widgets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/cellrenderers/" class="md-nav__link">
        cellrenderers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/common/" class="md-nav__link">
        common
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/contextual_menu/" class="md-nav__link">
        contextual_menu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/download_progress_box/" class="md-nav__link">
        download_progress_box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/game_bar/" class="md-nav__link">
        game_bar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/gi_composites/" class="md-nav__link">
        gi_composites
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/log_text_view/" class="md-nav__link">
        log_text_view
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/notifications/" class="md-nav__link">
        notifications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/searchable_combobox/" class="md-nav__link">
        searchable_combobox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/sidebar/" class="md-nav__link">
        sidebar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/status_icon/" class="md-nav__link">
        status_icon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/utils/" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gui/widgets/window/" class="md-nav__link">
        window
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_12" type="checkbox" id="__nav_3_1_12" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_12">
          installer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="installer" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_12">
          <span class="md-nav__icon md-icon"></span>
          installer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Index
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Index
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lutris.installer" class="md-nav__link">
    lutris.installer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.AUTO_ELF_EXE" class="md-nav__link">
    AUTO_ELF_EXE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.AUTO_WIN32_EXE" class="md-nav__link">
    AUTO_WIN32_EXE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.get_installers" class="md-nav__link">
    get_installers()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.read_script" class="md-nav__link">
    read_script()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.commands" class="md-nav__link">
    commands
  </a>
  
    <nav class="md-nav" aria-label="commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin" class="md-nav__link">
    CommandsMixin
  </a>
  
    <nav class="md-nav" aria-label="CommandsMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.autosetup_gog_game" class="md-nav__link">
    autosetup_gog_game()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.chmodx" class="md-nav__link">
    chmodx()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.copy" class="md-nav__link">
    copy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.extract" class="md-nav__link">
    extract()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.get_wine_path" class="md-nav__link">
    get_wine_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.input_menu" class="md-nav__link">
    input_menu()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.insert_disc" class="md-nav__link">
    insert_disc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.merge" class="md-nav__link">
    merge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.mkdir" class="md-nav__link">
    mkdir()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.move" class="md-nav__link">
    move()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.rename" class="md-nav__link">
    rename()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.substitute_vars" class="md-nav__link">
    substitute_vars()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.task" class="md-nav__link">
    task()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.write_config" class="md-nav__link">
    write_config()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.write_file" class="md-nav__link">
    write_file()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.write_json" class="md-nav__link">
    write_json()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.errors" class="md-nav__link">
    errors
  </a>
  
    <nav class="md-nav" aria-label="errors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.FileNotAvailable" class="md-nav__link">
    FileNotAvailable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.MissingGameDependency" class="md-nav__link">
    MissingGameDependency
  </a>
  
    <nav class="md-nav" aria-label="MissingGameDependency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.MissingGameDependency.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.ScriptingError" class="md-nav__link">
    ScriptingError
  </a>
  
    <nav class="md-nav" aria-label="ScriptingError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.ScriptingError.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.ScriptingError.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.ScriptingError.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.error_handler" class="md-nav__link">
    error_handler()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.installer" class="md-nav__link">
    installer
  </a>
  
    <nav class="md-nav" aria-label="installer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller" class="md-nav__link">
    LutrisInstaller
  </a>
  
    <nav class="md-nav" aria-label="LutrisInstaller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.creates_game_folder" class="md-nav__link">
    creates_game_folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.script_pretty" class="md-nav__link">
    script_pretty
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_appid" class="md-nav__link">
    get_appid()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_errors" class="md-nav__link">
    get_errors()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_game_config" class="md-nav__link">
    get_game_config()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_game_id" class="md-nav__link">
    get_game_id()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_game_launcher_config" class="md-nav__link">
    get_game_launcher_config()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_service" class="md-nav__link">
    get_service()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.pop_user_provided_file" class="md-nav__link">
    pop_user_provided_file()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.prepare_game_files" class="md-nav__link">
    prepare_game_files()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.installer_file" class="md-nav__link">
    installer_file
  </a>
  
    <nav class="md-nav" aria-label="installer_file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile" class="md-nav__link">
    InstallerFile
  </a>
  
    <nav class="md-nav" aria-label="InstallerFile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.cache_path" class="md-nav__link">
    cache_path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.cached_filename" class="md-nav__link">
    cached_filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.checksum" class="md-nav__link">
    checksum
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.dest_file" class="md-nav__link">
    dest_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.filename" class="md-nav__link">
    filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.human_url" class="md-nav__link">
    human_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.is_cached" class="md-nav__link">
    is_cached
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.provider" class="md-nav__link">
    provider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.providers" class="md-nav__link">
    providers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.referer" class="md-nav__link">
    referer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.url" class="md-nav__link">
    url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.check_hash" class="md-nav__link">
    check_hash()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.is_downloadable" class="md-nav__link">
    is_downloadable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.prepare" class="md-nav__link">
    prepare()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.uses_pga_cache" class="md-nav__link">
    uses_pga_cache()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.interpreter" class="md-nav__link">
    interpreter
  </a>
  
    <nav class="md-nav" aria-label="interpreter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter" class="md-nav__link">
    ScriptInterpreter
  </a>
  
    <nav class="md-nav" aria-label="ScriptInterpreter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.appid" class="md-nav__link">
    appid
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.cache_path" class="md-nav__link">
    cache_path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.script_env" class="md-nav__link">
    script_env
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.cleanup" class="md-nav__link">
    cleanup()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.create_game_folder" class="md-nav__link">
    create_game_folder()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.eject_wine_disc" class="md-nav__link">
    eject_wine_disc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.get_default_target" class="md-nav__link">
    get_default_target()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.get_extras" class="md-nav__link">
    get_extras()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.get_runner_class" class="md-nav__link">
    get_runner_class()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.get_runners_to_install" class="md-nav__link">
    get_runners_to_install()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.install_runner" class="md-nav__link">
    install_runner()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.install_runners" class="md-nav__link">
    install_runners()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.launch_install" class="md-nav__link">
    launch_install()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.launch_installer_commands" class="md-nav__link">
    launch_installer_commands()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.revert" class="md-nav__link">
    revert()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.legacy" class="md-nav__link">
    legacy
  </a>
  
    <nav class="md-nav" aria-label="legacy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.legacy.get_game_launcher" class="md-nav__link">
    get_game_launcher()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer" class="md-nav__link">
    steam_installer
  </a>
  
    <nav class="md-nav" aria-label="steam_installer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller" class="md-nav__link">
    SteamInstaller
  </a>
  
    <nav class="md-nav" aria-label="SteamInstaller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller.steam_rel_path" class="md-nav__link">
    steam_rel_path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller.get_steam_data_path" class="md-nav__link">
    get_steam_data_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller.install_steam_game" class="md-nav__link">
    install_steam_game()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller.on_steam_game_installed" class="md-nav__link">
    on_steam_game_installed()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="commands/" class="md-nav__link">
        commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="errors/" class="md-nav__link">
        errors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="installer/" class="md-nav__link">
        installer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="installer_file/" class="md-nav__link">
        installer_file
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="interpreter/" class="md-nav__link">
        interpreter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="legacy/" class="md-nav__link">
        legacy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="steam_installer/" class="md-nav__link">
        steam_installer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_13" type="checkbox" id="__nav_3_1_13" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_13">
          migrations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="migrations" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_13">
          <span class="md-nav__icon md-icon"></span>
          migrations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../migrations/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../migrations/mess_to_mame/" class="md-nav__link">
        mess_to_mame
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../migrations/migrate_banners/" class="md-nav__link">
        migrate_banners
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../migrations/migrate_hidden_ids/" class="md-nav__link">
        migrate_hidden_ids
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../migrations/migrate_steam_appids/" class="md-nav__link">
        migrate_steam_appids
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runner_interpreter/" class="md-nav__link">
        runner_interpreter
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_15" type="checkbox" id="__nav_3_1_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_15">
          runners
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="runners" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_15">
          <span class="md-nav__icon md-icon"></span>
          runners
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/atari800/" class="md-nav__link">
        atari800
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_15_3" type="checkbox" id="__nav_3_1_15_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_15_3">
          commands
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="commands" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_15_3">
          <span class="md-nav__icon md-icon"></span>
          commands
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/commands/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/commands/dosbox/" class="md-nav__link">
        dosbox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/commands/wine/" class="md-nav__link">
        wine
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/dolphin/" class="md-nav__link">
        dolphin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/dosbox/" class="md-nav__link">
        dosbox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/easyrpg/" class="md-nav__link">
        easyrpg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/fsuae/" class="md-nav__link">
        fsuae
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/hatari/" class="md-nav__link">
        hatari
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/json/" class="md-nav__link">
        json
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/jzintv/" class="md-nav__link">
        jzintv
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/libretro/" class="md-nav__link">
        libretro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/linux/" class="md-nav__link">
        linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/mame/" class="md-nav__link">
        mame
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/mednafen/" class="md-nav__link">
        mednafen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/mupen64plus/" class="md-nav__link">
        mupen64plus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/o2em/" class="md-nav__link">
        o2em
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/openmsx/" class="md-nav__link">
        openmsx
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/osmose/" class="md-nav__link">
        osmose
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/pcsx2/" class="md-nav__link">
        pcsx2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/pico8/" class="md-nav__link">
        pico8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/redream/" class="md-nav__link">
        redream
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/reicast/" class="md-nav__link">
        reicast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/residualvm/" class="md-nav__link">
        residualvm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/rpcs3/" class="md-nav__link">
        rpcs3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/runner/" class="md-nav__link">
        runner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/ryujinx/" class="md-nav__link">
        ryujinx
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/scummvm/" class="md-nav__link">
        scummvm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/snes9x/" class="md-nav__link">
        snes9x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/steam/" class="md-nav__link">
        steam
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/vice/" class="md-nav__link">
        vice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/web/" class="md-nav__link">
        web
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/wine/" class="md-nav__link">
        wine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/yuzu/" class="md-nav__link">
        yuzu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runners/zdoom/" class="md-nav__link">
        zdoom
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/" class="md-nav__link">
        runtime
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_17" type="checkbox" id="__nav_3_1_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_17">
          scanners
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="scanners" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_17">
          <span class="md-nav__icon md-icon"></span>
          scanners
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scanners/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scanners/lutris/" class="md-nav__link">
        lutris
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scanners/retroarch/" class="md-nav__link">
        retroarch
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_18" type="checkbox" id="__nav_3_1_18" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_18">
          services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="services" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_18">
          <span class="md-nav__icon md-icon"></span>
          services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/base/" class="md-nav__link">
        base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/battlenet/" class="md-nav__link">
        battlenet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/bethesda/" class="md-nav__link">
        bethesda
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/dolphin/" class="md-nav__link">
        dolphin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/egs/" class="md-nav__link">
        egs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/gog/" class="md-nav__link">
        gog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/humblebundle/" class="md-nav__link">
        humblebundle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/itchio/" class="md-nav__link">
        itchio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/lutris/" class="md-nav__link">
        lutris
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/mame/" class="md-nav__link">
        mame
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/origin/" class="md-nav__link">
        origin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/scummvm/" class="md-nav__link">
        scummvm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/service_game/" class="md-nav__link">
        service_game
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/service_media/" class="md-nav__link">
        service_media
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/steam/" class="md-nav__link">
        steam
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/steamwindows/" class="md-nav__link">
        steamwindows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/tosec/" class="md-nav__link">
        tosec
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/ubisoft/" class="md-nav__link">
        ubisoft
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/xdg/" class="md-nav__link">
        xdg
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../settings/" class="md-nav__link">
        settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../startup/" class="md-nav__link">
        startup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../style_manager/" class="md-nav__link">
        style_manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sysoptions/" class="md-nav__link">
        sysoptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_23" type="checkbox" id="__nav_3_1_23" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_23">
          util
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="util" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_23">
          <span class="md-nav__icon md-icon"></span>
          util
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/audio/" class="md-nav__link">
        audio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/cookies/" class="md-nav__link">
        cookies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/datapath/" class="md-nav__link">
        datapath
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/display/" class="md-nav__link">
        display
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_23_6" type="checkbox" id="__nav_3_1_23_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_23_6">
          dolphin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="dolphin" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_23_6">
          <span class="md-nav__icon md-icon"></span>
          dolphin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/dolphin/" class="md-nav__link">
        Dolphin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/dolphin/cache_reader/" class="md-nav__link">
        cache_reader
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/downloader/" class="md-nav__link">
        downloader
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_23_8" type="checkbox" id="__nav_3_1_23_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_23_8">
          egs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="egs" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_23_8">
          <span class="md-nav__icon md-icon"></span>
          egs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/egs/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/egs/egs_launcher/" class="md-nav__link">
        egs_launcher
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/extract/" class="md-nav__link">
        extract
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/fileio/" class="md-nav__link">
        fileio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/game_finder/" class="md-nav__link">
        game_finder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/gamecontrollerdb/" class="md-nav__link">
        gamecontrollerdb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/gog/" class="md-nav__link">
        gog
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_23_14" type="checkbox" id="__nav_3_1_23_14" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_23_14">
          graphics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="graphics" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_23_14">
          <span class="md-nav__icon md-icon"></span>
          graphics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/graphics/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/graphics/displayconfig/" class="md-nav__link">
        displayconfig
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/graphics/drivers/" class="md-nav__link">
        drivers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/graphics/glxinfo/" class="md-nav__link">
        glxinfo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/graphics/vkquery/" class="md-nav__link">
        vkquery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/graphics/xephyr/" class="md-nav__link">
        xephyr
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/graphics/xrandr/" class="md-nav__link">
        xrandr
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/http/" class="md-nav__link">
        http
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/i18n/" class="md-nav__link">
        i18n
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/jobs/" class="md-nav__link">
        jobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/joypad/" class="md-nav__link">
        joypad
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/keyring/" class="md-nav__link">
        keyring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/libretro/" class="md-nav__link">
        libretro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/linux/" class="md-nav__link">
        linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/log/" class="md-nav__link">
        log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/magic/" class="md-nav__link">
        magic
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_23_24" type="checkbox" id="__nav_3_1_23_24" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_23_24">
          mame
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="mame" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_23_24">
          <span class="md-nav__icon md-icon"></span>
          mame
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/mame/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/mame/database/" class="md-nav__link">
        database
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/mame/ini/" class="md-nav__link">
        ini
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/nvidia/" class="md-nav__link">
        nvidia
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/process/" class="md-nav__link">
        process
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/process_watcher/" class="md-nav__link">
        process_watcher
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/resources/" class="md-nav__link">
        resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_23_29" type="checkbox" id="__nav_3_1_23_29" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_23_29">
          retroarch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="retroarch" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_23_29">
          <span class="md-nav__icon md-icon"></span>
          retroarch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/retroarch/core_config/" class="md-nav__link">
        core_config
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/settings/" class="md-nav__link">
        settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/shell/" class="md-nav__link">
        shell
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_23_32" type="checkbox" id="__nav_3_1_23_32" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_23_32">
          steam
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="steam" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_23_32">
          <span class="md-nav__icon md-icon"></span>
          steam
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/steam/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/steam/appmanifest/" class="md-nav__link">
        appmanifest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/steam/config/" class="md-nav__link">
        config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/steam/log/" class="md-nav__link">
        log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/steam/vdf/" class="md-nav__link">
        vdf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/steam/watcher/" class="md-nav__link">
        watcher
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/strings/" class="md-nav__link">
        strings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/system/" class="md-nav__link">
        system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/test_config/" class="md-nav__link">
        test_config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/timer/" class="md-nav__link">
        timer
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_23_37" type="checkbox" id="__nav_3_1_23_37" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_23_37">
          ubisoft
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ubisoft" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_23_37">
          <span class="md-nav__icon md-icon"></span>
          ubisoft
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/ubisoft/client/" class="md-nav__link">
        client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/ubisoft/consts/" class="md-nav__link">
        consts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/ubisoft/helpers/" class="md-nav__link">
        helpers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/ubisoft/parser/" class="md-nav__link">
        parser
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/update_cache/" class="md-nav__link">
        update_cache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/urlhandler/" class="md-nav__link">
        urlhandler
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_23_40" type="checkbox" id="__nav_3_1_23_40" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_23_40">
          wine
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="wine" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_23_40">
          <span class="md-nav__icon md-icon"></span>
          wine
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/cabinstall/" class="md-nav__link">
        cabinstall
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/d3d_extras/" class="md-nav__link">
        d3d_extras
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/dgvoodoo2/" class="md-nav__link">
        dgvoodoo2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/dll_manager/" class="md-nav__link">
        dll_manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/dxvk/" class="md-nav__link">
        dxvk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/dxvk_nvapi/" class="md-nav__link">
        dxvk_nvapi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/fsync/" class="md-nav__link">
        fsync
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/prefix/" class="md-nav__link">
        prefix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/registry/" class="md-nav__link">
        registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/vkd3d/" class="md-nav__link">
        vkd3d
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/wine/wine/" class="md-nav__link">
        wine
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/xdgshortcuts/" class="md-nav__link">
        xdgshortcuts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/yaml/" class="md-nav__link">
        yaml
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Development" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lutris.installer" class="md-nav__link">
    lutris.installer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.AUTO_ELF_EXE" class="md-nav__link">
    AUTO_ELF_EXE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.AUTO_WIN32_EXE" class="md-nav__link">
    AUTO_WIN32_EXE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.get_installers" class="md-nav__link">
    get_installers()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.read_script" class="md-nav__link">
    read_script()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.commands" class="md-nav__link">
    commands
  </a>
  
    <nav class="md-nav" aria-label="commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin" class="md-nav__link">
    CommandsMixin
  </a>
  
    <nav class="md-nav" aria-label="CommandsMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.autosetup_gog_game" class="md-nav__link">
    autosetup_gog_game()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.chmodx" class="md-nav__link">
    chmodx()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.copy" class="md-nav__link">
    copy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.extract" class="md-nav__link">
    extract()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.get_wine_path" class="md-nav__link">
    get_wine_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.input_menu" class="md-nav__link">
    input_menu()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.insert_disc" class="md-nav__link">
    insert_disc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.merge" class="md-nav__link">
    merge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.mkdir" class="md-nav__link">
    mkdir()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.move" class="md-nav__link">
    move()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.rename" class="md-nav__link">
    rename()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.substitute_vars" class="md-nav__link">
    substitute_vars()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.task" class="md-nav__link">
    task()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.write_config" class="md-nav__link">
    write_config()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.write_file" class="md-nav__link">
    write_file()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.commands.CommandsMixin.write_json" class="md-nav__link">
    write_json()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.errors" class="md-nav__link">
    errors
  </a>
  
    <nav class="md-nav" aria-label="errors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.FileNotAvailable" class="md-nav__link">
    FileNotAvailable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.MissingGameDependency" class="md-nav__link">
    MissingGameDependency
  </a>
  
    <nav class="md-nav" aria-label="MissingGameDependency">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.MissingGameDependency.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.ScriptingError" class="md-nav__link">
    ScriptingError
  </a>
  
    <nav class="md-nav" aria-label="ScriptingError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.ScriptingError.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.ScriptingError.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.ScriptingError.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.errors.error_handler" class="md-nav__link">
    error_handler()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.installer" class="md-nav__link">
    installer
  </a>
  
    <nav class="md-nav" aria-label="installer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller" class="md-nav__link">
    LutrisInstaller
  </a>
  
    <nav class="md-nav" aria-label="LutrisInstaller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.creates_game_folder" class="md-nav__link">
    creates_game_folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.script_pretty" class="md-nav__link">
    script_pretty
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_appid" class="md-nav__link">
    get_appid()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_errors" class="md-nav__link">
    get_errors()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_game_config" class="md-nav__link">
    get_game_config()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_game_id" class="md-nav__link">
    get_game_id()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_game_launcher_config" class="md-nav__link">
    get_game_launcher_config()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.get_service" class="md-nav__link">
    get_service()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.pop_user_provided_file" class="md-nav__link">
    pop_user_provided_file()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.prepare_game_files" class="md-nav__link">
    prepare_game_files()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer.LutrisInstaller.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.installer_file" class="md-nav__link">
    installer_file
  </a>
  
    <nav class="md-nav" aria-label="installer_file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile" class="md-nav__link">
    InstallerFile
  </a>
  
    <nav class="md-nav" aria-label="InstallerFile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.cache_path" class="md-nav__link">
    cache_path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.cached_filename" class="md-nav__link">
    cached_filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.checksum" class="md-nav__link">
    checksum
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.dest_file" class="md-nav__link">
    dest_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.filename" class="md-nav__link">
    filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.human_url" class="md-nav__link">
    human_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.is_cached" class="md-nav__link">
    is_cached
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.provider" class="md-nav__link">
    provider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.providers" class="md-nav__link">
    providers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.referer" class="md-nav__link">
    referer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.url" class="md-nav__link">
    url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.check_hash" class="md-nav__link">
    check_hash()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.is_downloadable" class="md-nav__link">
    is_downloadable()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.prepare" class="md-nav__link">
    prepare()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.installer_file.InstallerFile.uses_pga_cache" class="md-nav__link">
    uses_pga_cache()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.interpreter" class="md-nav__link">
    interpreter
  </a>
  
    <nav class="md-nav" aria-label="interpreter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter" class="md-nav__link">
    ScriptInterpreter
  </a>
  
    <nav class="md-nav" aria-label="ScriptInterpreter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.appid" class="md-nav__link">
    appid
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.cache_path" class="md-nav__link">
    cache_path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.script_env" class="md-nav__link">
    script_env
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.cleanup" class="md-nav__link">
    cleanup()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.create_game_folder" class="md-nav__link">
    create_game_folder()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.eject_wine_disc" class="md-nav__link">
    eject_wine_disc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.get_default_target" class="md-nav__link">
    get_default_target()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.get_extras" class="md-nav__link">
    get_extras()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.get_runner_class" class="md-nav__link">
    get_runner_class()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.get_runners_to_install" class="md-nav__link">
    get_runners_to_install()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.install_runner" class="md-nav__link">
    install_runner()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.install_runners" class="md-nav__link">
    install_runners()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.launch_install" class="md-nav__link">
    launch_install()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.launch_installer_commands" class="md-nav__link">
    launch_installer_commands()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.interpreter.ScriptInterpreter.revert" class="md-nav__link">
    revert()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.legacy" class="md-nav__link">
    legacy
  </a>
  
    <nav class="md-nav" aria-label="legacy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.legacy.get_game_launcher" class="md-nav__link">
    get_game_launcher()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer" class="md-nav__link">
    steam_installer
  </a>
  
    <nav class="md-nav" aria-label="steam_installer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller" class="md-nav__link">
    SteamInstaller
  </a>
  
    <nav class="md-nav" aria-label="SteamInstaller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller.steam_rel_path" class="md-nav__link">
    steam_rel_path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller.get_steam_data_path" class="md-nav__link">
    get_steam_data_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller.install_steam_game" class="md-nav__link">
    install_steam_game()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lutris.installer.steam_installer.SteamInstaller.on_steam_game_installed" class="md-nav__link">
    on_steam_game_installed()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/lutris/lutris/edit/master/docs/lutris/installer/__init__.py" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



  <h1>Index</h1>

<div class="doc doc-object doc-module">

<a id="lutris.installer"></a>
    <div class="doc doc-contents first">

      <p>Install script interpreter package.</p>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h2 id="lutris.installer.AUTO_ELF_EXE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">AUTO_ELF_EXE</span></code>


<a href="#lutris.installer.AUTO_ELF_EXE" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h2 id="lutris.installer.AUTO_WIN32_EXE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">AUTO_WIN32_EXE</span></code>


<a href="#lutris.installer.AUTO_WIN32_EXE" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h2 id="lutris.installer.get_installers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_installers</span><span class="p">(</span><span class="n">game_slug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">installer_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">revision</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#lutris.installer.get_installers" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_installers</span><span class="p">(</span><span class="n">game_slug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">installer_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">revision</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># check if installer is local or online</span>
    <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="n">installer_file</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">read_script</span><span class="p">(</span><span class="n">installer_file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">get_game_installers</span><span class="p">(</span><span class="n">game_slug</span><span class="o">=</span><span class="n">game_slug</span><span class="p">,</span> <span class="n">revision</span><span class="o">=</span><span class="n">revision</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="lutris.installer.read_script" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_script</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>


<a href="#lutris.installer.read_script" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Return scripts from a local file</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_script</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return scripts from a local file&quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Loading script(s) from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">local_file</span><span class="p">:</span>
        <span class="n">script</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">local_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">script</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">script</span>
        <span class="k">if</span> <span class="s2">&quot;results&quot;</span> <span class="ow">in</span> <span class="n">script</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">script</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">script</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-module">



<h2 id="lutris.installer.commands" class="doc doc-heading">
        <code>commands</code>



<a href="#lutris.installer.commands" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Commands for installer scripts</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="lutris.installer.commands.CommandsMixin" class="doc doc-heading">
        <code>
CommandsMixin        </code>



<a href="#lutris.installer.commands.CommandsMixin" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The directives for the <code>installer:</code> part of the install script.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CommandsMixin</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The directives for the `installer:` part of the install script.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CommandsMixin</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This class is a mixin&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_runner_version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the version of the runner used for the installer&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="o">==</span> <span class="s2">&quot;wine&quot;</span><span class="p">:</span>
            <span class="c1"># If a version is specified in the script choose this one</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">)</span>
            <span class="c1"># If the installer is a extension, use the wine version from the base game</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">requires</span><span class="p">:</span>
                <span class="n">db_game</span> <span class="o">=</span> <span class="n">get_game_by_field</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">requires</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;installer_slug&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">db_game</span><span class="p">:</span>
                    <span class="n">db_game</span> <span class="o">=</span> <span class="n">get_game_by_field</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">requires</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;slug&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">db_game</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find game </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">requires</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="n">game</span> <span class="o">=</span> <span class="n">Game</span><span class="p">(</span><span class="n">db_game</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">game</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">runner_config</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="o">==</span> <span class="s2">&quot;libretro&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">][</span><span class="s2">&quot;core&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check_required_params</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">command_data</span><span class="p">,</span> <span class="n">command_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify presence of a list of parameters required by a command.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">params</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">param_present</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">command_data</span><span class="p">:</span>
                        <span class="n">param_present</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">param_present</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span>
                        <span class="n">_</span><span class="p">(</span><span class="s2">&quot;One of </span><span class="si">{params}</span><span class="s2"> parameter is mandatory for the </span><span class="si">{cmd}</span><span class="s2"> command&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">params</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot; or &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">param</span><span class="p">),</span> <span class="n">cmd</span><span class="o">=</span><span class="n">command_name</span><span class="p">),</span>
                        <span class="n">command_data</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">command_data</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span>
                        <span class="n">_</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{param}</span><span class="s2"> parameter is mandatory for the </span><span class="si">{cmd}</span><span class="s2"> command&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">cmd</span><span class="o">=</span><span class="n">command_name</span><span class="p">),</span>
                        <span class="n">command_data</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_is_cached_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether a file referenced by file_id is stored in the cache&quot;&quot;&quot;</span>
        <span class="n">pga_cache_path</span> <span class="o">=</span> <span class="n">get_cache_path</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pga_cache_path</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">file_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">pga_cache_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">chmodx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make filename executable&quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid file &#39;</span><span class="si">%s</span><span class="s2">&#39;. Can&#39;t make it executable&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">system</span><span class="o">.</span><span class="n">make_executable</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run an executable file.&quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">terminal</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">working_dir</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">env</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;command&quot;</span><span class="p">)],</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;execute&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;command&quot;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="s2">&quot;file&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span>
                    <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Parameters file and command can&#39;t be used &quot;</span>
                      <span class="s2">&quot;at the same time for the execute command&quot;</span><span class="p">),</span>
                    <span class="n">data</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="c1"># Accept return codes other than 0</span>
            <span class="k">if</span> <span class="s2">&quot;return_code&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">return_code</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;return_code&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_code</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>

            <span class="n">exec_path</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">args_string</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">args_string</span><span class="p">):</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
            <span class="n">terminal</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;terminal&quot;</span><span class="p">)</span>
            <span class="n">working_dir</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;working_dir&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disable_runtime&quot;</span><span class="p">):</span>
                <span class="c1"># Possibly need to handle prefer_system_libs here</span>
                <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">runtime</span><span class="o">.</span><span class="n">get_env</span><span class="p">())</span>

            <span class="c1"># Loading environment variables set in the script</span>
            <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script_env</span><span class="p">)</span>

            <span class="c1"># Environment variables can also be passed to the execute command</span>
            <span class="n">local_env</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;env&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
            <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">local_env</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
            <span class="n">include_processes</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;include_processes&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="n">exclude_processes</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exclude_processes&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">include_processes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">exclude_processes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;No parameters supplied to execute command.&quot;</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="n">exec_path</span> <span class="o">=</span> <span class="s2">&quot;bash&quot;</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">strip</span><span class="p">())]</span>
            <span class="n">include_processes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;bash&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Determine whether &#39;file&#39; value is a file id or a path</span>
            <span class="n">exec_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">exec_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="n">exec_path</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">system</span><span class="o">.</span><span class="n">is_executable</span><span class="p">(</span><span class="n">exec_path</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Making </span><span class="si">%s</span><span class="s2"> executable&quot;</span><span class="p">,</span> <span class="n">exec_path</span><span class="p">)</span>
            <span class="n">system</span><span class="o">.</span><span class="n">make_executable</span><span class="p">(</span><span class="n">exec_path</span><span class="p">)</span>
        <span class="n">exec_abs_path</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">find_executable</span><span class="p">(</span><span class="n">exec_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exec_abs_path</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Unable to find executable </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">exec_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">terminal</span><span class="p">:</span>
            <span class="n">terminal</span> <span class="o">=</span> <span class="n">linux</span><span class="o">.</span><span class="n">get_default_terminal</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">working_dir</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">working_dir</span><span class="p">):</span>
            <span class="n">working_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span>

        <span class="n">command</span> <span class="o">=</span> <span class="n">MonitoredCommand</span><span class="p">(</span>
            <span class="p">[</span><span class="n">exec_abs_path</span><span class="p">]</span> <span class="o">+</span> <span class="n">args</span><span class="p">,</span>
            <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
            <span class="n">term</span><span class="o">=</span><span class="n">terminal</span><span class="p">,</span>
            <span class="n">cwd</span><span class="o">=</span><span class="n">working_dir</span><span class="p">,</span>
            <span class="n">include_processes</span><span class="o">=</span><span class="n">include_processes</span><span class="p">,</span>
            <span class="n">exclude_processes</span><span class="o">=</span><span class="n">exclude_processes</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">command</span><span class="o">.</span><span class="n">accepted_return_code</span> <span class="o">=</span> <span class="n">return_code</span>
        <span class="n">command</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">attach_logger</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heartbeat</span> <span class="o">=</span> <span class="n">GLib</span><span class="o">.</span><span class="n">timeout_add</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_task</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;STOP&quot;</span>

    <span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extract a file, guessing the compression method.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;src&quot;</span><span class="p">)],</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;extract&quot;</span><span class="p">)</span>
        <span class="n">src_param</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">)</span>
        <span class="n">filespec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">src_param</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filespec</span><span class="p">):</span>
            <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">filespec</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filenames</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">filespec</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> does not exist&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">filespec</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;dst&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">dest_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;dst&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dest_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Extracting </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">set_status</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
            <span class="n">merge_single</span> <span class="o">=</span> <span class="s2">&quot;nomerge&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span>
            <span class="n">extractor</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;extracting file </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">dest_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_killable_process</span><span class="p">(</span><span class="n">extract</span><span class="o">.</span><span class="n">extract_archive</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">dest_path</span><span class="p">,</span> <span class="n">merge_single</span><span class="p">,</span> <span class="n">extractor</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Extract done&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">input_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display an input request as a dropdown menu with options.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">(</span><span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;input_menu&quot;</span><span class="p">)</span>
        <span class="n">identifier</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
        <span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;INPUT_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">identifier</span> <span class="k">if</span> <span class="n">identifier</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">has_entry</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entry&quot;</span><span class="p">)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;options&quot;</span><span class="p">]</span>
        <span class="n">preselect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;preselect&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">input_menu</span><span class="p">,</span>
            <span class="n">alias</span><span class="p">,</span>
            <span class="n">options</span><span class="p">,</span>
            <span class="n">preselect</span><span class="p">,</span>
            <span class="n">has_entry</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_on_input_menu_validated</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;STOP&quot;</span>

    <span class="k">def</span> <span class="nf">_on_input_menu_validated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_widget</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">alias</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">choosen_option</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">get_active_id</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">choosen_option</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_inputs</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="n">alias</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">choosen_option</span><span class="p">})</span>
            <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">continue_button</span><span class="o">.</span><span class="n">hide</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_iter_commands</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">insert_disc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Request user to insert an optical disc&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">(</span><span class="s2">&quot;requires&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;insert_disc&quot;</span><span class="p">)</span>
        <span class="n">requires</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;requires&quot;</span><span class="p">)</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;message&quot;</span><span class="p">,</span>
            <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Insert or mount game disc and click Autodetect or</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="s2">&quot;use Browse if the disc is mounted on a non standard location.&quot;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="n">_</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Lutris is looking for a mounted disk drive or image </span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="s2">&quot;containing the following file or folder:</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="s2">&quot;&lt;i&gt;</span><span class="si">%s</span><span class="s2">&lt;/i&gt;&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">requires</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="o">==</span> <span class="s2">&quot;wine&quot;</span><span class="p">:</span>
            <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">eject_button</span><span class="o">.</span><span class="n">show</span><span class="p">)</span>
        <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">ask_for_disc</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_matching_disc</span><span class="p">,</span> <span class="n">requires</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;STOP&quot;</span>

    <span class="k">def</span> <span class="nf">_find_matching_disc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_widget</span><span class="p">,</span> <span class="n">requires</span><span class="p">,</span> <span class="n">extra_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">extra_path</span><span class="p">:</span>
            <span class="n">drives</span> <span class="o">=</span> <span class="p">[</span><span class="n">extra_path</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">drives</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_mounted_discs</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">drive</span> <span class="ow">in</span> <span class="n">drives</span><span class="p">:</span>
            <span class="n">required_abspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">drive</span><span class="p">,</span> <span class="n">requires</span><span class="p">)</span>
            <span class="n">required_abspath</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">fix_path_case</span><span class="p">(</span><span class="n">required_abspath</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">required_abspath</span> <span class="ow">and</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="n">required_abspath</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found </span><span class="si">%s</span><span class="s2"> on cdrom </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="p">,</span> <span class="n">drive</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">game_disc</span> <span class="o">=</span> <span class="n">drive</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_iter_commands</span><span class="p">()</span>
                <span class="k">break</span>

    <span class="k">def</span> <span class="nf">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create directory&quot;&quot;&quot;</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Directory </span><span class="si">%s</span><span class="s2"> already exists&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Created directory </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Merge the contents given by src to destination folder dst&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;merge&quot;</span><span class="p">)</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_move_paths</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Merging </span><span class="si">%s</span><span class="s2"> into </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;optional&quot;</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Optional path </span><span class="si">%s</span><span class="s2"> not present&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Source does not exist: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">src</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
            <span class="c1"># If single file, copy it and change reference in game file so it</span>
            <span class="c1"># can be used as executable. Skip copying if the source is the same</span>
            <span class="c1"># as destination.</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">src</span><span class="p">)</span> <span class="o">!=</span> <span class="n">dst</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_killable_process</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_files</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">game_files</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_killable_process</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">merge_folders</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias for merge&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move a file or directory into a destination folder.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;move&quot;</span><span class="p">)</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_move_paths</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Moving </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;optional&quot;</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Optional path </span><span class="si">%s</span><span class="s2"> not present&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid source for &#39;move&#39; operation: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">src</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">src</span><span class="p">)</span> <span class="o">==</span> <span class="n">dst</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Source file is the same as destination, skipping&quot;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">src</span><span class="p">))):</span>
                <span class="c1"># May not be the best choice, but it&#39;s the safest.</span>
                <span class="c1"># Maybe should display confirmation dialog (Overwrite / Skip) ?</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Destination file exists, skipping&quot;</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_cached_file</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
                <span class="n">action</span> <span class="o">=</span> <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">action</span> <span class="o">=</span> <span class="n">shutil</span><span class="o">.</span><span class="n">move</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_killable_process</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">shutil</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Can&#39;t move </span><span class="si">{src}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">to destination </span><span class="si">{dst}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">dst</span><span class="p">))</span> <span class="kn">from</span> <span class="nn">err</span>

    <span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rename file or folder.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;rename&quot;</span><span class="p">)</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_move_paths</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Rename error, source path does not exist: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">src</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dst</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>  <span class="c1"># Remove if empty</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dst</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Rename error, destination already exists: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">src</span><span class="p">)</span>
        <span class="n">dst_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>

        <span class="c1"># Pre-move on dest filesystem to avoid error with</span>
        <span class="c1"># os.rename through different filesystems</span>
        <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dst_dir</span><span class="p">,</span> <span class="s2">&quot;lutris_rename_temp&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_killable_process</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">temp_dir</span><span class="p">)</span>
        <span class="n">src</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
        <span class="n">os</span><span class="o">.</span><span class="n">renames</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_move_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Process raw &#39;src&#39; and &#39;dst&#39; data.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">src_ref</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Missing parameter src&quot;</span><span class="p">))</span> <span class="kn">from</span> <span class="nn">err</span>
        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_files</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">src_ref</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">src_ref</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">src</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Wrong value for &#39;src&#39; param&quot;</span><span class="p">),</span> <span class="n">src_ref</span><span class="p">)</span>
        <span class="n">dst_ref</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;dst&quot;</span><span class="p">]</span>
        <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">dst_ref</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dst</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Wrong value for &#39;dst&#39; param&quot;</span><span class="p">),</span> <span class="n">dst_ref</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">src</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">),</span> <span class="n">dst</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">substitute_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Subsitute variable names found in given file.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;substitute_vars&quot;</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Substituting variables for file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">tmp_filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.tmp&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">source_file</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dest_file</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>
                <span class="k">while</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">source_file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="n">dest_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">tmp_filename</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_task_runner_and_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_name</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">task_name</span><span class="p">:</span>
            <span class="c1"># Run a task from a different runner</span>
            <span class="c1"># than the one for this installer</span>
            <span class="n">runner_name</span><span class="p">,</span> <span class="n">task_name</span> <span class="o">=</span> <span class="n">task_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">runner_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span>
        <span class="k">return</span> <span class="n">runner_name</span><span class="p">,</span> <span class="n">task_name</span>

    <span class="k">def</span> <span class="nf">get_wine_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return absolute path of wine version used during the install&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">get_wine_version_exe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_runner_version</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Directive triggering another function specific to a runner.</span>

<span class="sd">        The &#39;name&#39; parameter is mandatory. If &#39;args&#39; is provided it will be</span>
<span class="sd">        passed to the runner task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;task&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">cancel_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">runner_name</span><span class="p">,</span> <span class="n">task_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_task_runner_and_name</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>

        <span class="c1"># Accept return codes other than 0</span>
        <span class="k">if</span> <span class="s2">&quot;return_code&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">return_code</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;return_code&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">return_code</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>

        <span class="k">if</span> <span class="n">runner_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;wine&quot;</span><span class="p">):</span>
            <span class="n">wine_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wine_path</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">wine_path</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="s2">&quot;wine_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wine_path</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;prefix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prefix&quot;</span><span class="p">)</span> \
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prefix&quot;</span><span class="p">)</span> \
                <span class="ow">or</span> <span class="s2">&quot;$GAMEDIR&quot;</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;arch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;arch&quot;</span><span class="p">)</span> \
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;arch&quot;</span><span class="p">)</span> \
                <span class="ow">or</span> <span class="n">WINE_DEFAULT_ARCH</span>
            <span class="k">if</span> <span class="n">task_name</span> <span class="o">==</span> <span class="s2">&quot;wineexec&quot;</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="s2">&quot;env&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">script_env</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">inner_key</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">value</span><span class="p">[</span><span class="n">inner_key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">inner_key</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="n">value</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="n">task</span> <span class="o">=</span> <span class="n">import_task</span><span class="p">(</span><span class="n">runner_name</span><span class="p">,</span> <span class="n">task_name</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">task</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
            <span class="n">command</span><span class="o">.</span><span class="n">accepted_return_code</span> <span class="o">=</span> <span class="n">return_code</span>
        <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">cancel_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">MonitoredCommand</span><span class="p">):</span>
            <span class="c1"># Monitor thread and continue when task has executed</span>
            <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">attach_logger</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heartbeat</span> <span class="o">=</span> <span class="n">GLib</span><span class="o">.</span><span class="n">timeout_add</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_task</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;STOP&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_monitor_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">command</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Return code: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">.</span><span class="n">return_code</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span><span class="o">.</span><span class="n">return_code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">accepted_return_code</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Command exited with code </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">command</span><span class="o">.</span><span class="n">return_code</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_iter_commands</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">write_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write text to a file.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;write_file&quot;</span><span class="p">)</span>

        <span class="c1"># Get file</span>
        <span class="n">dest_file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">])</span>

        <span class="c1"># Create dir if necessary</span>
        <span class="n">basedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">dest_file_path</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">mode</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mode</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Wrong value for write_file mode: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">mode</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dest_file_path</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dest_file</span><span class="p">:</span>
            <span class="n">dest_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">write_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write data into a json file.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;write_json&quot;</span><span class="p">)</span>

        <span class="c1"># Get file</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">])</span>

        <span class="c1"># Create dir if necessary</span>
        <span class="n">basedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">merge</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;merge&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># create an empty file if it doesn&#39;t exist</span>
        <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">touch</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span> <span class="k">if</span> <span class="n">merge</span> <span class="k">else</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">json_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">merge</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to parse JSON from file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

            <span class="n">json_data</span> <span class="o">=</span> <span class="n">selective_merge</span><span class="p">(</span><span class="n">json_data</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="p">{}))</span>
            <span class="n">json_file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">json_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">write_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write a key-value pair into an INI type config file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;write_config&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;section&quot;</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;write_config&quot;</span><span class="p">)</span>
        <span class="c1"># Get file</span>
        <span class="n">config_file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">])</span>

        <span class="c1"># Create dir if necessary</span>
        <span class="n">basedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">merge</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;merge&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="n">EvilConfigParser</span><span class="p">(</span><span class="n">allow_no_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dict_type</span><span class="o">=</span><span class="n">MultiOrderedDict</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>  <span class="c1"># Preserve text case</span>
        <span class="k">if</span> <span class="n">merge</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;section&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">data</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;section&quot;</span><span class="p">]][</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">section</span><span class="p">,</span> <span class="n">keys</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">parser</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="n">section</span><span class="p">):</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">config_file</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_file_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileid</span><span class="p">):</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_files</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">file_path</span>

    <span class="k">def</span> <span class="nf">_killable_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run function `func` in a separate, killable process.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">process</span><span class="p">:</span>
            <span class="n">result_obj</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">abort_current_task</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">terminate</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result_obj</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># Wait process end &amp; re-raise exceptions</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">abort_current_task</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Process </span><span class="si">%s</span><span class="s2"> returned: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_extract_gog_game</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extract</span><span class="p">({</span>
            <span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="n">file_id</span><span class="p">,</span>
            <span class="s2">&quot;dst&quot;</span><span class="p">:</span> <span class="s2">&quot;$GAMEDIR&quot;</span><span class="p">,</span>
            <span class="s2">&quot;extractor&quot;</span><span class="p">:</span> <span class="s2">&quot;innoextract&quot;</span>
        <span class="p">})</span>
        <span class="n">app_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span> <span class="s2">&quot;app&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="n">app_path</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">app_content</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">app_path</span><span class="p">):</span>
                <span class="n">source_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">app_path</span><span class="p">,</span> <span class="n">app_content</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span> <span class="n">app_content</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">merge</span><span class="p">({</span><span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="n">source_path</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">})</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">({</span><span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="n">source_path</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">})</span>
        <span class="n">support_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span> <span class="s2">&quot;__support/app&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="n">support_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">merge</span><span class="p">({</span><span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="n">support_path</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">_get_scummvm_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gog_config_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a ScummVM configuration from the GOG config files&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">gog_config_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">gog_config_file</span><span class="p">:</span>
            <span class="n">gog_config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">gog_config_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">game_tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">task</span> <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">gog_config</span><span class="p">[</span><span class="s2">&quot;playTasks&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">task</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;game&quot;</span><span class="p">]</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="n">game_tasks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;arguments&quot;</span><span class="p">]</span>
        <span class="n">game_id</span> <span class="o">=</span> <span class="n">arguments</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">arguments</span><span class="o">.</span><span class="n">split</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">gog_config_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;game_id&quot;</span><span class="p">:</span> <span class="n">game_id</span><span class="p">,</span>
            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">base_dir</span><span class="p">,</span>
            <span class="s2">&quot;arguments&quot;</span><span class="p">:</span> <span class="n">arguments</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">autosetup_gog_game</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Automatically guess the best way to install a GOG game by inspecting its contents.</span>
<span class="sd">        This chooses the right runner (DOSBox, Wine) for Windows game files.</span>
<span class="sd">        Linux setup files don&#39;t use innosetup, they can be unzipped instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_files</span><span class="p">[</span><span class="n">file_id</span><span class="p">]</span>
        <span class="n">file_list</span> <span class="o">=</span> <span class="n">extract</span><span class="o">.</span><span class="n">get_innoextract_list</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="n">dosbox_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">scummvm_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">windows_override_found</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># DOS games that also have a Windows executable</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;dosbox/dosbox.exe&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">dosbox_found</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="s2">&quot;scummvm/scummvm.exe&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">scummvm_found</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="s2">&quot;_some_windows.exe&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="c1"># There&#39;s not a good way to handle exceptions without extracting the .info file</span>
                <span class="c1"># before extracting the game. Added for Quake but GlQuake.exe doesn&#39;t run on modern wine</span>
                <span class="n">windows_override_found</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">dosbox_found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">windows_override_found</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extract_gog_game</span><span class="p">(</span><span class="n">file_id</span><span class="p">)</span>
            <span class="n">dosbox_config</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;working_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;$GAMEDIR/DOSBOX&quot;</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_single.conf&quot;</span><span class="p">):</span>
                    <span class="n">dosbox_config</span><span class="p">[</span><span class="s2">&quot;main_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
                <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.conf&quot;</span><span class="p">):</span>
                    <span class="n">dosbox_config</span><span class="p">[</span><span class="s2">&quot;config_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dosbox_config</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="s2">&quot;dosbox&quot;</span>
        <span class="k">elif</span> <span class="n">scummvm_found</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extract_gog_game</span><span class="p">(</span><span class="n">file_id</span><span class="p">)</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;goggame&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.info&quot;</span><span class="p">):</span>
                    <span class="n">arguments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_scummvm_arguments</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">arguments</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unable to get ScummVM arguments&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;ScummVM config: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arguments</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="s2">&quot;scummvm&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="s2">&quot;/SP- /NOCANCEL&quot;</span>
            <span class="k">if</span> <span class="n">silent</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">+=</span> <span class="s2">&quot; /SUPPRESSMSGBOXES /VERYSILENT /NOGUI&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">is_gog</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">({</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;wineexec&quot;</span><span class="p">,</span>
                <span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;$GAMEDIR&quot;</span><span class="p">,</span>
                <span class="s2">&quot;executable&quot;</span><span class="p">:</span> <span class="n">file_id</span><span class="p">,</span>
                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="n">args</span>
            <span class="p">})</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#lutris.installer.commands.CommandsMixin.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CommandsMixin</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This class is a mixin&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.autosetup_gog_game" class="doc doc-heading">
<code class="highlight language-python"><span class="n">autosetup_gog_game</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.autosetup_gog_game" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Automatically guess the best way to install a GOG game by inspecting its contents.
This chooses the right runner (DOSBox, Wine) for Windows game files.
Linux setup files don't use innosetup, they can be unzipped instead.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">autosetup_gog_game</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Automatically guess the best way to install a GOG game by inspecting its contents.</span>
<span class="sd">    This chooses the right runner (DOSBox, Wine) for Windows game files.</span>
<span class="sd">    Linux setup files don&#39;t use innosetup, they can be unzipped instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_files</span><span class="p">[</span><span class="n">file_id</span><span class="p">]</span>
    <span class="n">file_list</span> <span class="o">=</span> <span class="n">extract</span><span class="o">.</span><span class="n">get_innoextract_list</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">dosbox_found</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">scummvm_found</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">windows_override_found</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># DOS games that also have a Windows executable</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;dosbox/dosbox.exe&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">dosbox_found</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s2">&quot;scummvm/scummvm.exe&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">scummvm_found</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s2">&quot;_some_windows.exe&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="c1"># There&#39;s not a good way to handle exceptions without extracting the .info file</span>
            <span class="c1"># before extracting the game. Added for Quake but GlQuake.exe doesn&#39;t run on modern wine</span>
            <span class="n">windows_override_found</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">dosbox_found</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">windows_override_found</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extract_gog_game</span><span class="p">(</span><span class="n">file_id</span><span class="p">)</span>
        <span class="n">dosbox_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;working_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;$GAMEDIR/DOSBOX&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_single.conf&quot;</span><span class="p">):</span>
                <span class="n">dosbox_config</span><span class="p">[</span><span class="s2">&quot;main_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
            <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.conf&quot;</span><span class="p">):</span>
                <span class="n">dosbox_config</span><span class="p">[</span><span class="s2">&quot;config_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dosbox_config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="s2">&quot;dosbox&quot;</span>
    <span class="k">elif</span> <span class="n">scummvm_found</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extract_gog_game</span><span class="p">(</span><span class="n">file_id</span><span class="p">)</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;goggame&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.info&quot;</span><span class="p">):</span>
                <span class="n">arguments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_scummvm_arguments</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">arguments</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unable to get ScummVM arguments&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;ScummVM config: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arguments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="s2">&quot;scummvm&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s2">&quot;/SP- /NOCANCEL&quot;</span>
        <span class="k">if</span> <span class="n">silent</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">+=</span> <span class="s2">&quot; /SUPPRESSMSGBOXES /VERYSILENT /NOGUI&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">is_gog</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">({</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;wineexec&quot;</span><span class="p">,</span>
            <span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;$GAMEDIR&quot;</span><span class="p">,</span>
            <span class="s2">&quot;executable&quot;</span><span class="p">:</span> <span class="n">file_id</span><span class="p">,</span>
            <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="n">args</span>
        <span class="p">})</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.chmodx" class="doc doc-heading">
<code class="highlight language-python"><span class="n">chmodx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.chmodx" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Make filename executable</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">chmodx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make filename executable&quot;&quot;&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid file &#39;</span><span class="si">%s</span><span class="s2">&#39;. Can&#39;t make it executable&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">system</span><span class="o">.</span><span class="n">make_executable</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.copy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.copy" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Alias for merge</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Alias for merge&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.execute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.execute" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Run an executable file.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run an executable file.&quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">terminal</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">working_dir</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">env</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;command&quot;</span><span class="p">)],</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;execute&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;command&quot;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="s2">&quot;file&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Parameters file and command can&#39;t be used &quot;</span>
                  <span class="s2">&quot;at the same time for the execute command&quot;</span><span class="p">),</span>
                <span class="n">data</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Accept return codes other than 0</span>
        <span class="k">if</span> <span class="s2">&quot;return_code&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">return_code</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;return_code&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">return_code</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>

        <span class="n">exec_path</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">args_string</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">args_string</span><span class="p">):</span>
            <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
        <span class="n">terminal</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;terminal&quot;</span><span class="p">)</span>
        <span class="n">working_dir</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;working_dir&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disable_runtime&quot;</span><span class="p">):</span>
            <span class="c1"># Possibly need to handle prefer_system_libs here</span>
            <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">runtime</span><span class="o">.</span><span class="n">get_env</span><span class="p">())</span>

        <span class="c1"># Loading environment variables set in the script</span>
        <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script_env</span><span class="p">)</span>

        <span class="c1"># Environment variables can also be passed to the execute command</span>
        <span class="n">local_env</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;env&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">env</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">local_env</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
        <span class="n">include_processes</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;include_processes&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="n">exclude_processes</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exclude_processes&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">include_processes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">exclude_processes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;No parameters supplied to execute command.&quot;</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
        <span class="n">exec_path</span> <span class="o">=</span> <span class="s2">&quot;bash&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">strip</span><span class="p">())]</span>
        <span class="n">include_processes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;bash&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Determine whether &#39;file&#39; value is a file id or a path</span>
        <span class="n">exec_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">exec_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="n">exec_path</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">system</span><span class="o">.</span><span class="n">is_executable</span><span class="p">(</span><span class="n">exec_path</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Making </span><span class="si">%s</span><span class="s2"> executable&quot;</span><span class="p">,</span> <span class="n">exec_path</span><span class="p">)</span>
        <span class="n">system</span><span class="o">.</span><span class="n">make_executable</span><span class="p">(</span><span class="n">exec_path</span><span class="p">)</span>
    <span class="n">exec_abs_path</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">find_executable</span><span class="p">(</span><span class="n">exec_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exec_abs_path</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Unable to find executable </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">exec_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">terminal</span><span class="p">:</span>
        <span class="n">terminal</span> <span class="o">=</span> <span class="n">linux</span><span class="o">.</span><span class="n">get_default_terminal</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">working_dir</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">working_dir</span><span class="p">):</span>
        <span class="n">working_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span>

    <span class="n">command</span> <span class="o">=</span> <span class="n">MonitoredCommand</span><span class="p">(</span>
        <span class="p">[</span><span class="n">exec_abs_path</span><span class="p">]</span> <span class="o">+</span> <span class="n">args</span><span class="p">,</span>
        <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
        <span class="n">term</span><span class="o">=</span><span class="n">terminal</span><span class="p">,</span>
        <span class="n">cwd</span><span class="o">=</span><span class="n">working_dir</span><span class="p">,</span>
        <span class="n">include_processes</span><span class="o">=</span><span class="n">include_processes</span><span class="p">,</span>
        <span class="n">exclude_processes</span><span class="o">=</span><span class="n">exclude_processes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">command</span><span class="o">.</span><span class="n">accepted_return_code</span> <span class="o">=</span> <span class="n">return_code</span>
    <span class="n">command</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">attach_logger</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">heartbeat</span> <span class="o">=</span> <span class="n">GLib</span><span class="o">.</span><span class="n">timeout_add</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_task</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;STOP&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.extract" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.extract" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Extract a file, guessing the compression method.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract a file, guessing the compression method.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;src&quot;</span><span class="p">)],</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;extract&quot;</span><span class="p">)</span>
    <span class="n">src_param</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">)</span>
    <span class="n">filespec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">src_param</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filespec</span><span class="p">):</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">filespec</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">filespec</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> does not exist&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">filespec</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;dst&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">dest_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;dst&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dest_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Extracting </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">set_status</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="n">merge_single</span> <span class="o">=</span> <span class="s2">&quot;nomerge&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span>
        <span class="n">extractor</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;extracting file </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">dest_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_killable_process</span><span class="p">(</span><span class="n">extract</span><span class="o">.</span><span class="n">extract_archive</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">dest_path</span><span class="p">,</span> <span class="n">merge_single</span><span class="p">,</span> <span class="n">extractor</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Extract done&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.get_wine_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_wine_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.get_wine_path" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return absolute path of wine version used during the install</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_wine_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return absolute path of wine version used during the install&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">get_wine_version_exe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_runner_version</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.input_menu" class="doc doc-heading">
<code class="highlight language-python"><span class="n">input_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.input_menu" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Display an input request as a dropdown menu with options.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">input_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display an input request as a dropdown menu with options.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">(</span><span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;input_menu&quot;</span><span class="p">)</span>
    <span class="n">identifier</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
    <span class="n">alias</span> <span class="o">=</span> <span class="s2">&quot;INPUT_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">identifier</span> <span class="k">if</span> <span class="n">identifier</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">has_entry</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entry&quot;</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;options&quot;</span><span class="p">]</span>
    <span class="n">preselect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;preselect&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
    <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">input_menu</span><span class="p">,</span>
        <span class="n">alias</span><span class="p">,</span>
        <span class="n">options</span><span class="p">,</span>
        <span class="n">preselect</span><span class="p">,</span>
        <span class="n">has_entry</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_input_menu_validated</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;STOP&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.insert_disc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">insert_disc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.insert_disc" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Request user to insert an optical disc</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">insert_disc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Request user to insert an optical disc&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">(</span><span class="s2">&quot;requires&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;insert_disc&quot;</span><span class="p">)</span>
    <span class="n">requires</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;requires&quot;</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">&quot;message&quot;</span><span class="p">,</span>
        <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Insert or mount game disc and click Autodetect or</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="s2">&quot;use Browse if the disc is mounted on a non standard location.&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">message</span> <span class="o">+=</span> <span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Lutris is looking for a mounted disk drive or image </span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="s2">&quot;containing the following file or folder:</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="s2">&quot;&lt;i&gt;</span><span class="si">%s</span><span class="s2">&lt;/i&gt;&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">requires</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="o">==</span> <span class="s2">&quot;wine&quot;</span><span class="p">:</span>
        <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">eject_button</span><span class="o">.</span><span class="n">show</span><span class="p">)</span>
    <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">ask_for_disc</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_matching_disc</span><span class="p">,</span> <span class="n">requires</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;STOP&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.merge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.merge" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Merge the contents given by src to destination folder dst</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Merge the contents given by src to destination folder dst&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;merge&quot;</span><span class="p">)</span>
    <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_move_paths</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Merging </span><span class="si">%s</span><span class="s2"> into </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;optional&quot;</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Optional path </span><span class="si">%s</span><span class="s2"> not present&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Source does not exist: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">src</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
        <span class="c1"># If single file, copy it and change reference in game file so it</span>
        <span class="c1"># can be used as executable. Skip copying if the source is the same</span>
        <span class="c1"># as destination.</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">src</span><span class="p">)</span> <span class="o">!=</span> <span class="n">dst</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_killable_process</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_files</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">game_files</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
        <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_killable_process</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">merge_folders</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.mkdir" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.mkdir" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create directory</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create directory&quot;&quot;&quot;</span>
    <span class="n">directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Directory </span><span class="si">%s</span><span class="s2"> already exists&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Created directory </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.move" class="doc doc-heading">
<code class="highlight language-python"><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.move" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Move a file or directory into a destination folder.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Move a file or directory into a destination folder.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;move&quot;</span><span class="p">)</span>
    <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_move_paths</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Moving </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;optional&quot;</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Optional path </span><span class="si">%s</span><span class="s2"> not present&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid source for &#39;move&#39; operation: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">src</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">src</span><span class="p">)</span> <span class="o">==</span> <span class="n">dst</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Source file is the same as destination, skipping&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">src</span><span class="p">))):</span>
            <span class="c1"># May not be the best choice, but it&#39;s the safest.</span>
            <span class="c1"># Maybe should display confirmation dialog (Overwrite / Skip) ?</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Destination file exists, skipping&quot;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_cached_file</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">shutil</span><span class="o">.</span><span class="n">move</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_killable_process</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">shutil</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Can&#39;t move </span><span class="si">{src}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">to destination </span><span class="si">{dst}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">dst</span><span class="p">))</span> <span class="kn">from</span> <span class="nn">err</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.rename" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.rename" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Rename file or folder.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rename file or folder.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;rename&quot;</span><span class="p">)</span>
    <span class="n">src</span><span class="p">,</span> <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_move_paths</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Rename error, source path does not exist: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">src</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dst</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>  <span class="c1"># Remove if empty</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dst</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Rename error, destination already exists: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">src</span><span class="p">)</span>
    <span class="n">dst_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>

    <span class="c1"># Pre-move on dest filesystem to avoid error with</span>
    <span class="c1"># os.rename through different filesystems</span>
    <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dst_dir</span><span class="p">,</span> <span class="s2">&quot;lutris_rename_temp&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_killable_process</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">temp_dir</span><span class="p">)</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
    <span class="n">os</span><span class="o">.</span><span class="n">renames</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.substitute_vars" class="doc doc-heading">
<code class="highlight language-python"><span class="n">substitute_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.substitute_vars" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Subsitute variable names found in given file.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">substitute_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Subsitute variable names found in given file.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;substitute_vars&quot;</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">])</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Substituting variables for file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">tmp_filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.tmp&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">source_file</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dest_file</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>
            <span class="k">while</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">source_file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">dest_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">tmp_filename</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.task" class="doc doc-heading">
<code class="highlight language-python"><span class="n">task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.task" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Directive triggering another function specific to a runner.</p>
<p>The 'name' parameter is mandatory. If 'args' is provided it will be
passed to the runner task.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Directive triggering another function specific to a runner.</span>

<span class="sd">    The &#39;name&#39; parameter is mandatory. If &#39;args&#39; is provided it will be</span>
<span class="sd">    passed to the runner task.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;task&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
        <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">cancel_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">runner_name</span><span class="p">,</span> <span class="n">task_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_task_runner_and_name</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>

    <span class="c1"># Accept return codes other than 0</span>
    <span class="k">if</span> <span class="s2">&quot;return_code&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">return_code</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;return_code&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">return_code</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>

    <span class="k">if</span> <span class="n">runner_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;wine&quot;</span><span class="p">):</span>
        <span class="n">wine_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wine_path</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">wine_path</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;wine_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wine_path</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;prefix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prefix&quot;</span><span class="p">)</span> \
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prefix&quot;</span><span class="p">)</span> \
            <span class="ow">or</span> <span class="s2">&quot;$GAMEDIR&quot;</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;arch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;arch&quot;</span><span class="p">)</span> \
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;arch&quot;</span><span class="p">)</span> \
            <span class="ow">or</span> <span class="n">WINE_DEFAULT_ARCH</span>
        <span class="k">if</span> <span class="n">task_name</span> <span class="o">==</span> <span class="s2">&quot;wineexec&quot;</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;env&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">script_env</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">inner_key</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">value</span><span class="p">[</span><span class="n">inner_key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">inner_key</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="n">value</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="n">task</span> <span class="o">=</span> <span class="n">import_task</span><span class="p">(</span><span class="n">runner_name</span><span class="p">,</span> <span class="n">task_name</span><span class="p">)</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">task</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">command</span><span class="p">:</span>
        <span class="n">command</span><span class="o">.</span><span class="n">accepted_return_code</span> <span class="o">=</span> <span class="n">return_code</span>
    <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">cancel_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">MonitoredCommand</span><span class="p">):</span>
        <span class="c1"># Monitor thread and continue when task has executed</span>
        <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">attach_logger</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heartbeat</span> <span class="o">=</span> <span class="n">GLib</span><span class="o">.</span><span class="n">timeout_add</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_task</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;STOP&quot;</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.write_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.write_config" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Write a key-value pair into an INI type config file.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">write_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write a key-value pair into an INI type config file.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;write_config&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;section&quot;</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;write_config&quot;</span><span class="p">)</span>
    <span class="c1"># Get file</span>
    <span class="n">config_file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">])</span>

    <span class="c1"># Create dir if necessary</span>
    <span class="n">basedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">merge</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;merge&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">EvilConfigParser</span><span class="p">(</span><span class="n">allow_no_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dict_type</span><span class="o">=</span><span class="n">MultiOrderedDict</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>  <span class="c1"># Preserve text case</span>
    <span class="k">if</span> <span class="n">merge</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;section&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">data</span><span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;section&quot;</span><span class="p">]][</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">section</span><span class="p">,</span> <span class="n">keys</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">parser</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="n">section</span><span class="p">):</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">config_file</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.write_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.write_file" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Write text to a file.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">write_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write text to a file.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;write_file&quot;</span><span class="p">)</span>

    <span class="c1"># Get file</span>
    <span class="n">dest_file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">])</span>

    <span class="c1"># Create dir if necessary</span>
    <span class="n">basedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">dest_file_path</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">mode</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">mode</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Wrong value for write_file mode: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">mode</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dest_file_path</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dest_file</span><span class="p">:</span>
        <span class="n">dest_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.commands.CommandsMixin.write_json" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>


<a href="#lutris.installer.commands.CommandsMixin.write_json" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Write data into a json file.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/commands.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">write_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write data into a json file.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_params</span><span class="p">([</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;write_json&quot;</span><span class="p">)</span>

    <span class="c1"># Get file</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_path</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">])</span>

    <span class="c1"># Create dir if necessary</span>
    <span class="n">basedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">merge</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;merge&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="c1"># create an empty file if it doesn&#39;t exist</span>
    <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">touch</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span> <span class="k">if</span> <span class="n">merge</span> <span class="k">else</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="n">json_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">merge</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to parse JSON from file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="n">json_data</span> <span class="o">=</span> <span class="n">selective_merge</span><span class="p">(</span><span class="n">json_data</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="n">json_file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">json_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="lutris.installer.errors" class="doc doc-heading">
        <code>errors</code>



<a href="#lutris.installer.errors" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Installer specific exceptions</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="lutris.installer.errors.FileNotAvailable" class="doc doc-heading">
        <code>
FileNotAvailable            (<span title="Exception">Exception</span>)
        </code>



<a href="#lutris.installer.errors.FileNotAvailable" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Raised when a file has to be provided by the user</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/errors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">FileNotAvailable</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Raised when a file has to be provided by the user&quot;&quot;&quot;</span>
</code></pre></div>
        </details>


    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="lutris.installer.errors.MissingGameDependency" class="doc doc-heading">
        <code>
MissingGameDependency            (<span title="Exception">Exception</span>)
        </code>



<a href="#lutris.installer.errors.MissingGameDependency" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Raise when a game requires another game that isn't installed</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/errors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">MissingGameDependency</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Raise when a game requires another game that isn&#39;t installed&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slug</span> <span class="o">=</span> <span class="n">slug</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.errors.MissingGameDependency.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#lutris.installer.errors.MissingGameDependency.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/errors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">slug</span> <span class="o">=</span> <span class="n">slug</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="lutris.installer.errors.ScriptingError" class="doc doc-heading">
        <code>
ScriptingError            (<span title="Exception">Exception</span>)
        </code>



<a href="#lutris.installer.errors.ScriptingError" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Custom exception for scripting errors, can be caught by modifying
excepthook.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/errors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ScriptingError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Custom exception for scripting errors, can be caught by modifying</span>
<span class="sd">    excepthook.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">faulty_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">faulty_data</span> <span class="o">=</span> <span class="n">faulty_data</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">faulty_data</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">faulty_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">faulty_data</span> <span class="k">if</span> <span class="n">faulty_data</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.errors.ScriptingError.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">faulty_data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#lutris.installer.errors.ScriptingError.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/errors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">faulty_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">faulty_data</span> <span class="o">=</span> <span class="n">faulty_data</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.errors.ScriptingError.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#lutris.installer.errors.ScriptingError.__repr__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/errors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.errors.ScriptingError.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#lutris.installer.errors.ScriptingError.__str__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/errors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">faulty_data</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">faulty_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">faulty_data</span> <span class="k">if</span> <span class="n">faulty_data</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="lutris.installer.errors.error_handler" class="doc doc-heading">
<code class="highlight language-python"><span class="n">error_handler</span><span class="p">(</span><span class="n">error_type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span></code>


<a href="#lutris.installer.errors.error_handler" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Intercept all possible exceptions and raise them as ScriptingErrors</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/errors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">error_handler</span><span class="p">(</span><span class="n">error_type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Intercept all possible exceptions and raise them as ScriptingErrors&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">error_type</span> <span class="o">==</span> <span class="n">ScriptingError</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">message</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">faulty_data</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&lt;b&gt;</span><span class="si">%s</span><span class="s2">&lt;/b&gt;&quot;</span> <span class="o">%</span> <span class="n">gtk_safe</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">faulty_data</span><span class="p">)</span>
        <span class="n">ErrorDialog</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_excepthook</span><span class="p">(</span><span class="n">error_type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="lutris.installer.installer" class="doc doc-heading">
        <code>installer</code>



<a href="#lutris.installer.installer" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Lutris installer class</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="lutris.installer.installer.LutrisInstaller" class="doc doc-heading">
        <code>
LutrisInstaller        </code>



<a href="#lutris.installer.installer.LutrisInstaller" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Represents a Lutris installer</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LutrisInstaller</span><span class="p">:</span>  <span class="c1"># pylint: disable=too-many-instance-attributes</span>
    <span class="sd">&quot;&quot;&quot;Represents a Lutris installer&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer</span><span class="p">,</span> <span class="n">interpreter</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">appid</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span> <span class="o">=</span> <span class="n">interpreter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">installer</span> <span class="o">=</span> <span class="n">installer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_update</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">installer</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slug</span> <span class="o">=</span> <span class="n">installer</span><span class="p">[</span><span class="s2">&quot;slug&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="n">installer</span><span class="p">[</span><span class="s2">&quot;runner&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">game_name</span> <span class="o">=</span> <span class="n">installer</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span> <span class="o">=</span> <span class="n">installer</span><span class="p">[</span><span class="s2">&quot;game_slug&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_service</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="n">service</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_appid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_appid</span><span class="p">(</span><span class="n">installer</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">appid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;variables&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">InstallerFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span><span class="p">,</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">file_meta</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">file_desc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;files&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">for</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">file_meta</span> <span class="ow">in</span> <span class="n">file_desc</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requires</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;requires&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extends</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extends&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">game_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_id</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_gog</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">get_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">initial</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">initial</span>
        <span class="k">if</span> <span class="s2">&quot;steam&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="ow">and</span> <span class="s2">&quot;steam&quot;</span> <span class="ow">in</span> <span class="n">SERVICES</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SERVICES</span><span class="p">[</span><span class="s2">&quot;steam&quot;</span><span class="p">]()</span>
        <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;humble&quot;</span> <span class="ow">in</span> <span class="n">version</span> <span class="ow">and</span> <span class="s2">&quot;humblebundle&quot;</span> <span class="ow">in</span> <span class="n">SERVICES</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SERVICES</span><span class="p">[</span><span class="s2">&quot;humblebundle&quot;</span><span class="p">]()</span>
        <span class="k">if</span> <span class="s2">&quot;gog&quot;</span> <span class="ow">in</span> <span class="n">version</span> <span class="ow">and</span> <span class="s2">&quot;gog&quot;</span> <span class="ow">in</span> <span class="n">SERVICES</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SERVICES</span><span class="p">[</span><span class="s2">&quot;gog&quot;</span><span class="p">]()</span>

    <span class="k">def</span> <span class="nf">get_appid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_dlc&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dlcid&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">initial</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">initial</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s2">&quot;steam&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;steamid&quot;</span><span class="p">)</span>
        <span class="n">game_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s2">&quot;gog&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">game_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gogid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gogid&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s2">&quot;humblebundle&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">game_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;humbleid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;humblestoreid&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">script_pretty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a pretty print of the script&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_game_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the ID of the game in the local DB if one exists&quot;&quot;&quot;</span>
        <span class="c1"># If the game is in the library and uninstalled, the first installation</span>
        <span class="c1"># updates it</span>
        <span class="n">existing_game</span> <span class="o">=</span> <span class="n">get_game_by_field</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span><span class="p">,</span> <span class="s2">&quot;slug&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">existing_game</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extends</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">existing_game</span><span class="p">[</span><span class="s2">&quot;installed&quot;</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">existing_game</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">creates_game_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determines if an install script should create a game folder for the game&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">requires</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">extends</span><span class="p">:</span>
            <span class="c1"># Game is an extension of an existing game, folder exists</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">==</span> <span class="s2">&quot;steam&quot;</span><span class="p">:</span>
            <span class="c1"># Steam games installs in their steamapps directory</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">files</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gog&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prefix&quot;</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">command_names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;installer&quot;</span><span class="p">,</span> <span class="p">[])]</span>
        <span class="k">if</span> <span class="s2">&quot;insert-disc&quot;</span> <span class="ow">in</span> <span class="n">command_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">get_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return potential errors in the script&quot;&quot;&quot;</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Script must be a dictionary&quot;</span><span class="p">)</span>
            <span class="c1"># Return early since the method assumes a dict</span>
            <span class="k">return</span> <span class="n">errors</span>

        <span class="c1"># Check that installers contains all required fields</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;runner&quot;</span><span class="p">,</span> <span class="s2">&quot;game_name&quot;</span><span class="p">,</span> <span class="s2">&quot;game_slug&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Missing field &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">field</span><span class="p">)</span>

        <span class="c1"># Check that libretro installers have a core specified</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">==</span> <span class="s2">&quot;libretro&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;game&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span> <span class="ow">or</span> <span class="s2">&quot;core&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Missing libretro core in game section&quot;</span><span class="p">)</span>

        <span class="c1"># Check that Steam games have an AppID</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">==</span> <span class="s2">&quot;steam&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;appid&quot;</span><span class="p">):</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Missing appid for Steam game&quot;</span><span class="p">)</span>

        <span class="c1"># Check that installers don&#39;t contain both &#39;requires&#39; and &#39;extends&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;requires&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extends&quot;</span><span class="p">):</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Scripts can&#39;t have both extends and requires&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">errors</span>

    <span class="k">def</span> <span class="nf">pop_user_provided_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return and remove the first user provided file, which is used for game stores&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">file</span><span class="o">.</span><span class="n">id</span>

    <span class="k">def</span> <span class="nf">prepare_game_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patch_version</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gathers necessary files before iterating through them.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No files to prepare&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No service to retrieve files from&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">online</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">is_connected</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not authenticated to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">installer_file_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_user_provided_file</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">installer_file_id</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Could not find a file for this service&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting files for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">installer_file_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">has_extras</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Adding selected extras to downloads&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">selected_extras</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">extras</span>
        <span class="k">if</span> <span class="n">patch_version</span><span class="p">:</span>
            <span class="c1"># If a patch version is given download the patch files instead of the installer</span>
            <span class="n">installer_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">get_patch_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer_file_id</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">installer_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">get_installer_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer_file_id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">installer_file</span> <span class="ow">in</span> <span class="n">installer_files</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">installer_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">installer_files</span><span class="p">:</span>
            <span class="c1"># Failed to get the service game, put back a user provided file</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Unable to get files from service. Setting </span><span class="si">%s</span><span class="s2"> to manual.&quot;</span><span class="p">,</span> <span class="n">installer_file_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">InstallerFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span><span class="p">,</span> <span class="n">installer_file_id</span><span class="p">,</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;N/A: Provider installer file&quot;</span><span class="p">,</span>
                <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
            <span class="p">}))</span>

    <span class="k">def</span> <span class="nf">_substitute_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">script_config</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Substitute values such as $GAMEDIR in a config dict.&quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">script_config</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Game config key must be a string&quot;</span><span class="p">),</span> <span class="n">key</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">script_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;false&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;launch_configs&quot;</span><span class="p">:</span>
                <span class="c1"># launch configuration don&#39;t need substitutions at least for now.</span>
                <span class="n">config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="n">config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">config</span>

    <span class="k">def</span> <span class="nf">get_game_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the game configuration&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">requires</span><span class="p">:</span>
            <span class="c1"># Load the base game config</span>
            <span class="n">required_game</span> <span class="o">=</span> <span class="n">get_game_by_field</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">requires</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;installer_slug&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">required_game</span><span class="p">:</span>
                <span class="n">required_game</span> <span class="o">=</span> <span class="n">get_game_by_field</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">requires</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;slug&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">required_game</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No game matched &#39;</span><span class="si">%s</span><span class="s2">&#39; on installer_slug or slug&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">requires</span><span class="p">)</span>
            <span class="n">base_config</span> <span class="o">=</span> <span class="n">LutrisConfig</span><span class="p">(</span>
                <span class="n">runner_slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">,</span> <span class="n">game_config_id</span><span class="o">=</span><span class="n">required_game</span><span class="p">[</span><span class="s2">&quot;configpath&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">base_config</span><span class="o">.</span><span class="n">game_level</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;game&quot;</span><span class="p">:</span> <span class="p">{}}</span>

        <span class="c1"># Config update</span>
        <span class="k">if</span> <span class="s2">&quot;system&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">:</span>
            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">]:</span>
            <span class="n">config</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">])</span>
        <span class="n">launcher</span><span class="p">,</span> <span class="n">launcher_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_launcher_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">game_files</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">launcher</span><span class="p">:</span>
            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">][</span><span class="n">launcher</span><span class="p">]</span> <span class="o">=</span> <span class="n">launcher_config</span>

        <span class="k">if</span> <span class="s2">&quot;game&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid &#39;game&#39; section&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">])</span> <span class="kn">from</span> <span class="nn">err</span>
            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute_config</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">AUTO_ELF_EXE</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exe&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
                <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">][</span><span class="s2">&quot;exe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_linux_game_executable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span>
                                                                   <span class="n">make_executable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">AUTO_WIN32_EXE</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exe&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
                <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">][</span><span class="s2">&quot;exe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_windows_game_executable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">config</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write the game configuration in the DB and config file&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extends</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;This is an extension to </span><span class="si">%s</span><span class="s2">, not creating a new game entry&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">extends</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_id</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_gog</span><span class="p">:</span>
            <span class="n">gog_config</span> <span class="o">=</span> <span class="n">get_gog_config_from_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">gog_config</span><span class="p">:</span>
                <span class="n">gog_game_path</span> <span class="o">=</span> <span class="n">get_gog_game_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
                <span class="n">lutris_config</span> <span class="o">=</span> <span class="n">convert_gog_config_to_lutris</span><span class="p">(</span><span class="n">gog_config</span><span class="p">,</span> <span class="n">gog_game_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">lutris_config</span><span class="p">)</span>

        <span class="n">configpath</span> <span class="o">=</span> <span class="n">write_game_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slug</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_config</span><span class="p">())</span>
        <span class="n">runner_inst</span> <span class="o">=</span> <span class="n">import_runner</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">)()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">:</span>
            <span class="n">service_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">service_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">game_id</span> <span class="o">=</span> <span class="n">add_or_update</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">game_name</span><span class="p">,</span>
            <span class="n">runner</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">,</span>
            <span class="n">slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span><span class="p">,</span>
            <span class="n">platform</span><span class="o">=</span><span class="n">runner_inst</span><span class="o">.</span><span class="n">get_platform</span><span class="p">(),</span>
            <span class="n">directory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span>
            <span class="n">installed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">hidden</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">installer_slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slug</span><span class="p">,</span>
            <span class="n">parent_slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">requires</span><span class="p">,</span>
            <span class="n">year</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
            <span class="n">configpath</span><span class="o">=</span><span class="n">configpath</span><span class="p">,</span>
            <span class="n">service</span><span class="o">=</span><span class="n">service_id</span><span class="p">,</span>
            <span class="n">service_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_appid</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">game_id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_id</span>

    <span class="k">def</span> <span class="nf">get_game_launcher_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game_files</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Game options such as exe or main_file can be added at the root of the</span>
<span class="sd">        script as a shortcut, this integrates them into the game config properly</span>
<span class="sd">        This should be deprecated. Game launchers should go in the game section.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">launcher</span><span class="p">,</span> <span class="n">launcher_value</span> <span class="o">=</span> <span class="n">get_game_launcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">launcher_value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">launcher_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">game_file</span> <span class="ow">in</span> <span class="n">launcher_value</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">game_file</span> <span class="ow">in</span> <span class="n">game_files</span><span class="p">:</span>
                    <span class="n">launcher_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">game_files</span><span class="p">[</span><span class="n">game_file</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">launcher_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">game_file</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">launcher</span><span class="p">,</span> <span class="n">launcher_values</span>
        <span class="k">if</span> <span class="n">launcher_value</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">launcher_value</span> <span class="ow">in</span> <span class="n">game_files</span><span class="p">:</span>
                <span class="n">launcher_value</span> <span class="o">=</span> <span class="n">game_files</span><span class="p">[</span><span class="n">launcher_value</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span> <span class="n">launcher_value</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">launcher_value</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span> <span class="n">launcher_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">launcher</span><span class="p">,</span> <span class="n">launcher_value</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer.LutrisInstaller.creates_game_folder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">creates_game_folder</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer.LutrisInstaller.creates_game_folder" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Determines if an install script should create a game folder for the game</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer.LutrisInstaller.script_pretty" class="doc doc-heading">
<code class="highlight language-python"><span class="n">script_pretty</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer.LutrisInstaller.script_pretty" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return a pretty print of the script</p>
    </div>

  </div>






  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer.LutrisInstaller.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer</span><span class="p">,</span> <span class="n">interpreter</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">appid</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#lutris.installer.installer.LutrisInstaller.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer</span><span class="p">,</span> <span class="n">interpreter</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">appid</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span> <span class="o">=</span> <span class="n">interpreter</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">installer</span> <span class="o">=</span> <span class="n">installer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_update</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">installer</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">slug</span> <span class="o">=</span> <span class="n">installer</span><span class="p">[</span><span class="s2">&quot;slug&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="n">installer</span><span class="p">[</span><span class="s2">&quot;runner&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game_name</span> <span class="o">=</span> <span class="n">installer</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span> <span class="o">=</span> <span class="n">installer</span><span class="p">[</span><span class="s2">&quot;game_slug&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">service</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_service</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="n">service</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">service_appid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_appid</span><span class="p">(</span><span class="n">installer</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">appid</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;variables&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">InstallerFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span><span class="p">,</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">file_meta</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">file_desc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;files&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">for</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">file_meta</span> <span class="ow">in</span> <span class="n">file_desc</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">requires</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;requires&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">extends</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extends&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_id</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_gog</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer.LutrisInstaller.get_appid" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_appid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#lutris.installer.installer.LutrisInstaller.get_appid" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_appid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;is_dlc&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dlcid&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">initial</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">initial</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s2">&quot;steam&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;steamid&quot;</span><span class="p">)</span>
    <span class="n">game_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s2">&quot;gog&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">game_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gogid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gogid&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s2">&quot;humblebundle&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">game_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;humbleid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">installer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;humblestoreid&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer.LutrisInstaller.get_errors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.installer.LutrisInstaller.get_errors" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return potential errors in the script</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return potential errors in the script&quot;&quot;&quot;</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Script must be a dictionary&quot;</span><span class="p">)</span>
        <span class="c1"># Return early since the method assumes a dict</span>
        <span class="k">return</span> <span class="n">errors</span>

    <span class="c1"># Check that installers contains all required fields</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;runner&quot;</span><span class="p">,</span> <span class="s2">&quot;game_name&quot;</span><span class="p">,</span> <span class="s2">&quot;game_slug&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Missing field &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">field</span><span class="p">)</span>

    <span class="c1"># Check that libretro installers have a core specified</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">==</span> <span class="s2">&quot;libretro&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;game&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span> <span class="ow">or</span> <span class="s2">&quot;core&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Missing libretro core in game section&quot;</span><span class="p">)</span>

    <span class="c1"># Check that Steam games have an AppID</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">==</span> <span class="s2">&quot;steam&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;appid&quot;</span><span class="p">):</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Missing appid for Steam game&quot;</span><span class="p">)</span>

    <span class="c1"># Check that installers don&#39;t contain both &#39;requires&#39; and &#39;extends&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;requires&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extends&quot;</span><span class="p">):</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Scripts can&#39;t have both extends and requires&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">errors</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer.LutrisInstaller.get_game_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_game_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.installer.LutrisInstaller.get_game_config" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return the game configuration</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_game_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the game configuration&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">requires</span><span class="p">:</span>
        <span class="c1"># Load the base game config</span>
        <span class="n">required_game</span> <span class="o">=</span> <span class="n">get_game_by_field</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">requires</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;installer_slug&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">required_game</span><span class="p">:</span>
            <span class="n">required_game</span> <span class="o">=</span> <span class="n">get_game_by_field</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">requires</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;slug&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">required_game</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No game matched &#39;</span><span class="si">%s</span><span class="s2">&#39; on installer_slug or slug&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">requires</span><span class="p">)</span>
        <span class="n">base_config</span> <span class="o">=</span> <span class="n">LutrisConfig</span><span class="p">(</span>
            <span class="n">runner_slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">,</span> <span class="n">game_config_id</span><span class="o">=</span><span class="n">required_game</span><span class="p">[</span><span class="s2">&quot;configpath&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">base_config</span><span class="o">.</span><span class="n">game_level</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;game&quot;</span><span class="p">:</span> <span class="p">{}}</span>

    <span class="c1"># Config update</span>
    <span class="k">if</span> <span class="s2">&quot;system&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">:</span>
        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">]:</span>
        <span class="n">config</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">])</span>
    <span class="n">launcher</span><span class="p">,</span> <span class="n">launcher_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_launcher_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">game_files</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">launcher</span><span class="p">:</span>
        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">][</span><span class="n">launcher</span><span class="p">]</span> <span class="o">=</span> <span class="n">launcher_config</span>

    <span class="k">if</span> <span class="s2">&quot;game&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid &#39;game&#39; section&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">])</span> <span class="kn">from</span> <span class="nn">err</span>
        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute_config</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">AUTO_ELF_EXE</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exe&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">][</span><span class="s2">&quot;exe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_linux_game_executable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span>
                                                               <span class="n">make_executable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">AUTO_WIN32_EXE</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;exe&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">][</span><span class="s2">&quot;exe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">find_windows_game_executable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer.LutrisInstaller.get_game_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_game_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.installer.LutrisInstaller.get_game_id" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return the ID of the game in the local DB if one exists</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_game_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the ID of the game in the local DB if one exists&quot;&quot;&quot;</span>
    <span class="c1"># If the game is in the library and uninstalled, the first installation</span>
    <span class="c1"># updates it</span>
    <span class="n">existing_game</span> <span class="o">=</span> <span class="n">get_game_by_field</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span><span class="p">,</span> <span class="s2">&quot;slug&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">existing_game</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extends</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">existing_game</span><span class="p">[</span><span class="s2">&quot;installed&quot;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="n">existing_game</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer.LutrisInstaller.get_game_launcher_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_game_launcher_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game_files</span><span class="p">)</span></code>


<a href="#lutris.installer.installer.LutrisInstaller.get_game_launcher_config" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Game options such as exe or main_file can be added at the root of the
script as a shortcut, this integrates them into the game config properly
This should be deprecated. Game launchers should go in the game section.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_game_launcher_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game_files</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Game options such as exe or main_file can be added at the root of the</span>
<span class="sd">    script as a shortcut, this integrates them into the game config properly</span>
<span class="sd">    This should be deprecated. Game launchers should go in the game section.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">launcher</span><span class="p">,</span> <span class="n">launcher_value</span> <span class="o">=</span> <span class="n">get_game_launcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">launcher_value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">launcher_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">game_file</span> <span class="ow">in</span> <span class="n">launcher_value</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">game_file</span> <span class="ow">in</span> <span class="n">game_files</span><span class="p">:</span>
                <span class="n">launcher_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">game_files</span><span class="p">[</span><span class="n">game_file</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">launcher_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">game_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">launcher</span><span class="p">,</span> <span class="n">launcher_values</span>
    <span class="k">if</span> <span class="n">launcher_value</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">launcher_value</span> <span class="ow">in</span> <span class="n">game_files</span><span class="p">:</span>
            <span class="n">launcher_value</span> <span class="o">=</span> <span class="n">game_files</span><span class="p">[</span><span class="n">launcher_value</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span> <span class="n">launcher_value</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">launcher_value</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span> <span class="n">launcher_value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">launcher</span><span class="p">,</span> <span class="n">launcher_value</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer.LutrisInstaller.get_service" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#lutris.installer.installer.LutrisInstaller.get_service" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">initial</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">initial</span>
    <span class="k">if</span> <span class="s2">&quot;steam&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="ow">and</span> <span class="s2">&quot;steam&quot;</span> <span class="ow">in</span> <span class="n">SERVICES</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SERVICES</span><span class="p">[</span><span class="s2">&quot;steam&quot;</span><span class="p">]()</span>
    <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="s2">&quot;humble&quot;</span> <span class="ow">in</span> <span class="n">version</span> <span class="ow">and</span> <span class="s2">&quot;humblebundle&quot;</span> <span class="ow">in</span> <span class="n">SERVICES</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SERVICES</span><span class="p">[</span><span class="s2">&quot;humblebundle&quot;</span><span class="p">]()</span>
    <span class="k">if</span> <span class="s2">&quot;gog&quot;</span> <span class="ow">in</span> <span class="n">version</span> <span class="ow">and</span> <span class="s2">&quot;gog&quot;</span> <span class="ow">in</span> <span class="n">SERVICES</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SERVICES</span><span class="p">[</span><span class="s2">&quot;gog&quot;</span><span class="p">]()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer.LutrisInstaller.pop_user_provided_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pop_user_provided_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.installer.LutrisInstaller.pop_user_provided_file" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return and remove the first user provided file, which is used for game stores</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pop_user_provided_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return and remove the first user provided file, which is used for game stores&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">file</span><span class="o">.</span><span class="n">id</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer.LutrisInstaller.prepare_game_files" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prepare_game_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patch_version</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#lutris.installer.installer.LutrisInstaller.prepare_game_files" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Gathers necessary files before iterating through them.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_game_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patch_version</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gathers necessary files before iterating through them.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No files to prepare&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No service to retrieve files from&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">online</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">is_connected</span><span class="p">():</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Not authenticated to </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">installer_file_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_user_provided_file</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">installer_file_id</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Could not find a file for this service&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Getting files for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">installer_file_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">has_extras</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Adding selected extras to downloads&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">selected_extras</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">extras</span>
    <span class="k">if</span> <span class="n">patch_version</span><span class="p">:</span>
        <span class="c1"># If a patch version is given download the patch files instead of the installer</span>
        <span class="n">installer_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">get_patch_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer_file_id</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">installer_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">get_installer_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer_file_id</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">installer_file</span> <span class="ow">in</span> <span class="n">installer_files</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">installer_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">installer_files</span><span class="p">:</span>
        <span class="c1"># Failed to get the service game, put back a user provided file</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Unable to get files from service. Setting </span><span class="si">%s</span><span class="s2"> to manual.&quot;</span><span class="p">,</span> <span class="n">installer_file_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">InstallerFile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span><span class="p">,</span> <span class="n">installer_file_id</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;N/A: Provider installer file&quot;</span><span class="p">,</span>
            <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
        <span class="p">}))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer.LutrisInstaller.save" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.installer.LutrisInstaller.save" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Write the game configuration in the DB and config file</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write the game configuration in the DB and config file&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extends</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;This is an extension to </span><span class="si">%s</span><span class="s2">, not creating a new game entry&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extends</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_id</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_gog</span><span class="p">:</span>
        <span class="n">gog_config</span> <span class="o">=</span> <span class="n">get_gog_config_from_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gog_config</span><span class="p">:</span>
            <span class="n">gog_game_path</span> <span class="o">=</span> <span class="n">get_gog_game_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
            <span class="n">lutris_config</span> <span class="o">=</span> <span class="n">convert_gog_config_to_lutris</span><span class="p">(</span><span class="n">gog_config</span><span class="p">,</span> <span class="n">gog_game_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">lutris_config</span><span class="p">)</span>

    <span class="n">configpath</span> <span class="o">=</span> <span class="n">write_game_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slug</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_game_config</span><span class="p">())</span>
    <span class="n">runner_inst</span> <span class="o">=</span> <span class="n">import_runner</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">)()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">:</span>
        <span class="n">service_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">service_id</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game_id</span> <span class="o">=</span> <span class="n">add_or_update</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">game_name</span><span class="p">,</span>
        <span class="n">runner</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">,</span>
        <span class="n">slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span><span class="p">,</span>
        <span class="n">platform</span><span class="o">=</span><span class="n">runner_inst</span><span class="o">.</span><span class="n">get_platform</span><span class="p">(),</span>
        <span class="n">directory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpreter</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span>
        <span class="n">installed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">hidden</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">installer_slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slug</span><span class="p">,</span>
        <span class="n">parent_slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">requires</span><span class="p">,</span>
        <span class="n">year</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
        <span class="n">configpath</span><span class="o">=</span><span class="n">configpath</span><span class="p">,</span>
        <span class="n">service</span><span class="o">=</span><span class="n">service_id</span><span class="p">,</span>
        <span class="n">service_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_appid</span><span class="p">,</span>
        <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">game_id</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_id</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="lutris.installer.installer_file" class="doc doc-heading">
        <code>installer_file</code>



<a href="#lutris.installer.installer_file" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Manipulates installer files</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="lutris.installer.installer_file.InstallerFile" class="doc doc-heading">
        <code>
InstallerFile        </code>



<a href="#lutris.installer.installer_file.InstallerFile" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Representation of a file in the <code>files</code> sections of an installer</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">InstallerFile</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Representation of a file in the `files` sections of an installer&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game_slug</span><span class="p">,</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">file_meta</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span> <span class="o">=</span> <span class="n">game_slug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">file_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span> <span class="o">=</span> <span class="n">file_meta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dest_file</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Used to override the destination</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">_url</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;url&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;missing field `url` for file `</span><span class="si">%s</span><span class="s2">`&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="n">_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span>
        <span class="k">if</span> <span class="n">_url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;file://&quot;</span> <span class="o">+</span> <span class="n">_url</span>
        <span class="k">return</span> <span class="n">_url</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;filename&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;missing field `filename` in file `</span><span class="si">%s</span><span class="s2">`&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">uses_pga_cache</span><span class="p">()</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached_filename</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;$STEAM&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">referer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;referer&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checksum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;checksum&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dest_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dest_file</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dest_file</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

    <span class="nd">@dest_file</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">dest_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dest_file</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">human_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the url in human readable format&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
            <span class="c1"># Ask the user where the file is located</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="s2">&quot;Please select file &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cached_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the filename of the first file in the cache path&quot;&quot;&quot;</span>
        <span class="n">cache_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cache_files</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cache_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">provider</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return file provider used&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;$STEAM&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;steam&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_cached</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;pga&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;user&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_downloadable</span><span class="p">():</span>
            <span class="k">return</span> <span class="s2">&quot;download&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported provider for </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">providers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return all supported providers&quot;&quot;&quot;</span>
        <span class="n">_providers</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;$STEAM&quot;</span><span class="p">):</span>
            <span class="n">_providers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;steam&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_cached</span><span class="p">:</span>
            <span class="n">_providers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;pga&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;N/A&quot;</span><span class="p">):</span>
            <span class="n">_providers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_downloadable</span><span class="p">():</span>
            <span class="n">_providers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;download&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_providers</span>

    <span class="k">def</span> <span class="nf">is_downloadable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if the file can be downloaded (even from the local filesystem)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;http&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">uses_pga_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determines whether the installer files are stored in a PGA cache</span>

<span class="sd">        Params:</span>
<span class="sd">            create (bool): If a cache is active, auto create directories if needed</span>
<span class="sd">        Returns:</span>
<span class="sd">            bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cache_path</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_cache_path</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cache_path</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="n">cache_path</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">create</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating cache path </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">)</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to created cache path: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ex</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Cache path </span><span class="si">%s</span><span class="s2"> does not exist&quot;</span><span class="p">,</span> <span class="n">cache_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the directory used as a cache for the duration of the installation&quot;&quot;&quot;</span>
        <span class="n">_cache_path</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_cache_path</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_cache_path</span><span class="p">:</span>
            <span class="n">_cache_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">CACHE_DIR</span><span class="p">,</span> <span class="s2">&quot;installer&quot;</span><span class="p">)</span>
        <span class="n">url_parts</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">url_parts</span><span class="o">.</span><span class="n">netloc</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;gog.com&quot;</span><span class="p">):</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="s2">&quot;gog&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_cache_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prepare the file for download&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks the checksum of `file` and compare it to `value`</span>

<span class="sd">        Args:</span>
<span class="sd">            checksum (str): The checksum to look for (type:hash)</span>
<span class="sd">            dest_file (str): The path to the destination file</span>
<span class="sd">            dest_file_uri (str): The uri for the destination file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest_file</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">hash_type</span><span class="p">,</span> <span class="n">expected_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid checksum, expected format (type:hash) &quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>

        <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">get_file_checksum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dest_file</span><span class="p">,</span> <span class="n">hash_type</span><span class="p">)</span> <span class="o">!=</span> <span class="n">expected_hash</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">hash_type</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot; checksum mismatch &quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_cached</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Is the file available in the local PGA cache?&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">uses_pga_cache</span><span class="p">()</span> <span class="ow">and</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dest_file</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer_file.InstallerFile.cache_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cache_path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.cache_path" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return the directory used as a cache for the duration of the installation</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer_file.InstallerFile.cached_filename" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cached_filename</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.cached_filename" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return the filename of the first file in the cache path</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer_file.InstallerFile.checksum" class="doc doc-heading">
<code class="highlight language-python"><span class="n">checksum</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.checksum" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer_file.InstallerFile.dest_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dest_file</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-writable"><code>writable</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.dest_file" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer_file.InstallerFile.filename" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filename</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.filename" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer_file.InstallerFile.human_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">human_url</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.human_url" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return the url in human readable format</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer_file.InstallerFile.is_cached" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_cached</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.is_cached" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Is the file available in the local PGA cache?</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer_file.InstallerFile.provider" class="doc doc-heading">
<code class="highlight language-python"><span class="n">provider</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.provider" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return file provider used</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer_file.InstallerFile.providers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">providers</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.providers" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return all supported providers</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer_file.InstallerFile.referer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">referer</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.referer" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.installer_file.InstallerFile.url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">url</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.url" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

    </div>

  </div>






  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer_file.InstallerFile.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game_slug</span><span class="p">,</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">file_meta</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game_slug</span><span class="p">,</span> <span class="n">file_id</span><span class="p">,</span> <span class="n">file_meta</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span> <span class="o">=</span> <span class="n">game_slug</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">file_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>  <span class="c1"># pylint: disable=invalid-name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_file_meta</span> <span class="o">=</span> <span class="n">file_meta</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dest_file</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Used to override the destination</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer_file.InstallerFile.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#lutris.installer.installer_file.InstallerFile.__str__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_slug</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer_file.InstallerFile.check_hash" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.installer_file.InstallerFile.check_hash" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Checks the checksum of <code>file</code> and compare it to <code>value</code></p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>checksum</code></td>
        <td><code>str</code></td>
        <td><p>The checksum to look for (type:hash)</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dest_file</code></td>
        <td><code>str</code></td>
        <td><p>The path to the destination file</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dest_file_uri</code></td>
        <td><code>str</code></td>
        <td><p>The uri for the destination file</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks the checksum of `file` and compare it to `value`</span>

<span class="sd">    Args:</span>
<span class="sd">        checksum (str): The checksum to look for (type:hash)</span>
<span class="sd">        dest_file (str): The path to the destination file</span>
<span class="sd">        dest_file_uri (str): The uri for the destination file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest_file</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">hash_type</span><span class="p">,</span> <span class="n">expected_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid checksum, expected format (type:hash) &quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>

    <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">get_file_checksum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dest_file</span><span class="p">,</span> <span class="n">hash_type</span><span class="p">)</span> <span class="o">!=</span> <span class="n">expected_hash</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">hash_type</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot; checksum mismatch &quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">checksum</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer_file.InstallerFile.is_downloadable" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_downloadable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.installer_file.InstallerFile.is_downloadable" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return True if the file can be downloaded (even from the local filesystem)</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_downloadable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return True if the file can be downloaded (even from the local filesystem)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;http&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer_file.InstallerFile.prepare" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.installer_file.InstallerFile.prepare" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Prepare the file for download</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prepare the file for download&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.installer_file.InstallerFile.uses_pga_cache" class="doc doc-heading">
<code class="highlight language-python"><span class="n">uses_pga_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#lutris.installer.installer_file.InstallerFile.uses_pga_cache" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Determines whether the installer files are stored in a PGA cache</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>create</code></td>
        <td><code>bool</code></td>
        <td><p>If a cache is active, auto create directories if needed</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>bool</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>lutris/installer/installer_file.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">uses_pga_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">create</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determines whether the installer files are stored in a PGA cache</span>

<span class="sd">    Params:</span>
<span class="sd">        create (bool): If a cache is active, auto create directories if needed</span>
<span class="sd">    Returns:</span>
<span class="sd">        bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_path</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_cache_path</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cache_path</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="n">cache_path</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">create</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating cache path </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">)</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to created cache path: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ex</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Cache path </span><span class="si">%s</span><span class="s2"> does not exist&quot;</span><span class="p">,</span> <span class="n">cache_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="lutris.installer.interpreter" class="doc doc-heading">
        <code>interpreter</code>



<a href="#lutris.installer.interpreter" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Install a game by following its install script.</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="lutris.installer.interpreter.ScriptInterpreter" class="doc doc-heading">
        <code>
ScriptInterpreter            (<span title="gi.overrides.GObject.Object">Object</span>, <a class="autorefs autorefs-internal" title="lutris.installer.commands.CommandsMixin" href="commands/#lutris.installer.commands.CommandsMixin">CommandsMixin</a>)
        </code>



<a href="#lutris.installer.interpreter.ScriptInterpreter" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Control the execution of an installer</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ScriptInterpreter</span><span class="p">(</span><span class="n">GObject</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span> <span class="n">CommandsMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Control the execution of an installer&quot;&quot;&quot;</span>

    <span class="n">__gsignals__</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;runners-installed&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">GObject</span><span class="o">.</span><span class="n">SIGNAL_RUN_FIRST</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">()),</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">service</span> <span class="k">if</span> <span class="n">parent</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">_appid</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">appid</span> <span class="k">if</span> <span class="n">parent</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">game_dir_created</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Whether a game folder was created during the install</span>
        <span class="c1"># Extra files for installers, either None if the extras haven&#39;t been checked yet.</span>
        <span class="c1"># Or a list of IDs of extras to be downloaded during the install</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extras</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">game_disc</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">game_files</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelled</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abort_current_task</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_inputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_command</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Current installer command when iterating through them</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runners_to_install</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">installer</span> <span class="o">=</span> <span class="n">LutrisInstaller</span><span class="p">(</span><span class="n">installer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">,</span> <span class="n">appid</span><span class="o">=</span><span class="n">_appid</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;This installer doesn&#39;t have a &#39;script&#39; section&quot;</span><span class="p">))</span>
        <span class="n">script_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">get_errors</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">script_errors</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid script: </span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_errors</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_resolution</span> <span class="o">=</span> <span class="n">DISPLAY_MANAGER</span><span class="o">.</span><span class="n">get_current_resolution</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_binary_dependencies</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_dependency</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">creates_game_folder</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_target</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">appid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Do not access appid from interpreter&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">service_appid</span>

    <span class="k">def</span> <span class="nf">get_default_target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return default installation dir&quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">LutrisConfig</span><span class="p">(</span><span class="n">runner_slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="p">)</span>
        <span class="n">games_dir</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">system_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game_path&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">:</span>
            <span class="n">service_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">service_dir</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">games_dir</span><span class="p">,</span> <span class="n">service_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">game_slug</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cache_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the directory used as a cache for the duration of the installation&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">CACHE_DIR</span><span class="p">,</span> <span class="s2">&quot;installer/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">game_slug</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">script_env</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the script&#39;s own environment variable with values</span>
<span class="sd">        susbtituted. This value can be used to provide the same environment</span>
<span class="sd">        variable as set for the game during the install process.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;env&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_game_dependency</span><span class="p">(</span><span class="n">dependency</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a game database row from a dependency name&quot;&quot;&quot;</span>
        <span class="n">game</span> <span class="o">=</span> <span class="n">get_game_by_field</span><span class="p">(</span><span class="n">dependency</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;installer_slug&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">game</span><span class="p">:</span>
            <span class="n">game</span> <span class="o">=</span> <span class="n">get_game_by_field</span><span class="p">(</span><span class="n">dependency</span><span class="p">,</span> <span class="s2">&quot;slug&quot;</span><span class="p">)</span>

        <span class="c1"># Game must be installed and have a directory</span>
        <span class="c1"># set so we can use that as the destination</span>
        <span class="k">if</span> <span class="n">game</span> <span class="ow">and</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;installed&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;directory&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">game</span>

    <span class="k">def</span> <span class="nf">_check_binary_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if all required binaries are installed on the system.</span>

<span class="sd">        This reads a `require-binaries` entry in the script, parsed the same way as</span>
<span class="sd">        the `requires` entry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">binary_dependencies</span> <span class="o">=</span> <span class="n">unpack_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;require-binaries&quot;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">binary_dependencies</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dependency</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">installed_binaries</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">dependency_option</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">find_executable</span><span class="p">(</span><span class="n">dependency_option</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">dependency_option</span> <span class="ow">in</span> <span class="n">dependency</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">installed_binaries</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                    <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;This installer requires </span><span class="si">%s</span><span class="s2"> on your system&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot; or &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dependency</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">system</span><span class="o">.</span><span class="n">find_executable</span><span class="p">(</span><span class="n">dependency</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;This installer requires </span><span class="si">%s</span><span class="s2"> on your system&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">dependency</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;When a game is a mod or an extension of another game, check that the base</span>
<span class="sd">        game is installed.</span>
<span class="sd">        If the game is available, install the game in the base game folder.</span>
<span class="sd">        The first game available listed in the dependencies is the one picked to base</span>
<span class="sd">        the installed on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">extends</span><span class="p">:</span>
            <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">extends</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dependencies</span> <span class="o">=</span> <span class="n">unpack_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">requires</span><span class="p">)</span>
        <span class="n">error_message</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;You need to install </span><span class="si">{}</span><span class="s2"> before&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dependencies</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dependency</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">installed_games</span> <span class="o">=</span> <span class="p">[</span><span class="n">dep</span> <span class="k">for</span> <span class="n">dep</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_game_dependency</span><span class="p">(</span><span class="n">dep</span><span class="p">)</span> <span class="k">for</span> <span class="n">dep</span> <span class="ow">in</span> <span class="n">dependency</span><span class="p">]</span> <span class="k">if</span> <span class="n">dep</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">installed_games</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dependency</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">MissingGameDependency</span><span class="p">(</span><span class="n">slug</span><span class="o">=</span><span class="n">dependency</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">error_message</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot; or &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dependency</span><span class="p">)))</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span> <span class="o">=</span> <span class="n">installed_games</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;directory&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">requires</span> <span class="o">=</span> <span class="n">installed_games</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;installer_slug&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">game</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_game_dependency</span><span class="p">(</span><span class="n">dependency</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">game</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">MissingGameDependency</span><span class="p">(</span><span class="n">slug</span><span class="o">=</span><span class="n">dependency</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span> <span class="o">=</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;directory&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">requires</span> <span class="o">=</span> <span class="n">game</span><span class="p">[</span><span class="s2">&quot;installer_slug&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_extras</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get extras and store them to move them at the end of the install&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking if service provide extra files&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">has_extras</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extras</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extras</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extras</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">get_extras</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">service_appid</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extras</span>

    <span class="k">def</span> <span class="nf">launch_install</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Launch the install process&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runners_to_install</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runners_to_install</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">install_runners</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_game_folder</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">create_game_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create the game folder if needed and store if is was created&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">files</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">creates_game_folder</span>
        <span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating destination path </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">game_dir_created</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">PermissionError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span>
                    <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Lutris does not have the necessary permissions to install to path:&quot;</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span>
                <span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>

    <span class="k">def</span> <span class="nf">get_runners_to_install</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the runner is installed before starting the installation</span>
<span class="sd">        Install the required runner(s) if necessary. This should handle runner</span>
<span class="sd">        dependencies or runners used for installer tasks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">runners_to_install</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">required_runners</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">runner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runner_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="p">)</span>
        <span class="n">required_runners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">runner</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;installer&quot;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">command_name</span><span class="p">,</span> <span class="n">command_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_command_name_and_params</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">command_name</span> <span class="o">==</span> <span class="s2">&quot;task&quot;</span><span class="p">:</span>
                <span class="n">runner_name</span><span class="p">,</span> <span class="n">_task_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_task_runner_and_name</span><span class="p">(</span><span class="n">command_params</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
                <span class="n">runner_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">required_runners</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">runner_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">runner_names</span><span class="p">:</span>
                    <span class="n">required_runners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_runner_class</span><span class="p">(</span><span class="n">runner_name</span><span class="p">)())</span>

        <span class="k">for</span> <span class="n">runner</span> <span class="ow">in</span> <span class="n">required_runners</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="o">==</span> <span class="s2">&quot;libretro&quot;</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;core&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">][</span><span class="s2">&quot;core&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;wine&quot;</span><span class="p">):</span>
                <span class="c1"># Force the wine version to be installed</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;fallback&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;min_version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wine</span><span class="o">.</span><span class="n">MIN_SAFE_VERSION</span>
                <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_runner_version</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">version</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Looking up default wine version</span>
                    <span class="n">default_wine</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">get_runner_version</span><span class="p">()</span> <span class="ow">or</span> <span class="p">{}</span>
                    <span class="k">if</span> <span class="s2">&quot;version&quot;</span> <span class="ow">in</span> <span class="n">default_wine</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Default wine version is </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">default_wine</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">])</span>
                        <span class="c1"># Set the version to both the is_installed params and</span>
                        <span class="c1"># the script itself so the version gets saved at the</span>
                        <span class="c1"># end of the install.</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">default_wine</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">],</span>
                                                 <span class="n">default_wine</span><span class="p">[</span><span class="s2">&quot;architecture&quot;</span><span class="p">])</span>
                        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="p">][</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get default wine version (got </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">default_wine</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">runner</span><span class="o">.</span><span class="n">is_installed</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Runner </span><span class="si">%s</span><span class="s2"> needs to be installed&quot;</span><span class="p">,</span> <span class="n">runner</span><span class="p">)</span>
                <span class="n">runners_to_install</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">runner</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;wine&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">get_wine_version</span><span class="p">():</span>
            <span class="n">WineNotInstalledWarning</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">runners_to_install</span>

    <span class="k">def</span> <span class="nf">install_runners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Install required runners for a game&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runners_to_install</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">install_runner</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runners_to_install</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;runners-installed&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">install_runner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runner</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Install runner required by the install script&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Installing </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">runner</span><span class="o">.</span><span class="n">install</span><span class="p">(</span>
                <span class="n">version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_runner_version</span><span class="p">(),</span>
                <span class="n">downloader</span><span class="o">=</span><span class="n">simple_downloader</span><span class="p">,</span>
                <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">install_runners</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">NonInstallableRunnerError</span><span class="p">,</span> <span class="n">RunnerInstallationError</span><span class="p">)</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">message</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">ex</span>

    <span class="k">def</span> <span class="nf">get_runner_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runner_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Runner the runner class from its name&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">runner</span> <span class="o">=</span> <span class="n">import_runner</span><span class="p">(</span><span class="n">runner_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">InvalidRunner</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">cancel_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid runner provided </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">runner_name</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
        <span class="k">return</span> <span class="n">runner</span>

    <span class="k">def</span> <span class="nf">launch_installer_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run the pre-installation steps and launch install.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Copy extras to game folder</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extras</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">files</span><span class="p">):</span>
            <span class="c1"># Reset the install script in case there are only extras.</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Installer with only extras and no game files&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;installer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">extra</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extras</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;installer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;copy&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="n">extra</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">:</span> <span class="s2">&quot;$GAMEDIR/extras&quot;</span><span class="p">}}</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iter_commands</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_iter_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exception</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s2">&quot;STOP&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">cancelled</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Installing game data&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">add_spinner</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">continue_button</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>

        <span class="n">commands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;installer&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">exception</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Last install command failed, show error&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">on_install_error</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">exception</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_command</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">commands</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="n">commands</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_command</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Installer commands are not formatted correctly&quot;</span><span class="p">))</span> <span class="kn">from</span> <span class="nn">err</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_command</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">method</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">status_text</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">status_text</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">status_text</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="n">status_text</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Installer command: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
            <span class="n">AsyncCall</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter_commands</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_finish_install</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_command_name_and_params</span><span class="p">(</span><span class="n">command_data</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">command_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">command_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">command_params</span> <span class="o">=</span> <span class="n">command_data</span><span class="p">[</span><span class="n">command_name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">command_name</span> <span class="o">=</span> <span class="n">command_data</span>
            <span class="n">command_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">command_name</span> <span class="o">=</span> <span class="n">command_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="c1"># Prevent private methods from being accessed as commands</span>
        <span class="n">command_name</span> <span class="o">=</span> <span class="n">command_name</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">command_name</span><span class="p">,</span> <span class="n">command_params</span>

    <span class="k">def</span> <span class="nf">_map_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Map a directive from the `installer` section to an internal</span>
<span class="sd">        method.&quot;&quot;&quot;</span>
        <span class="n">command_name</span><span class="p">,</span> <span class="n">command_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_command_name_and_params</span><span class="p">(</span><span class="n">command_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;The command &quot;</span><span class="si">%s</span><span class="s1">&quot; does not exist.&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">command_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_name</span><span class="p">),</span> <span class="n">command_params</span>

    <span class="k">def</span> <span class="nf">_finish_install</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">game_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

        <span class="n">launcher_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game&quot;</span><span class="p">):</span>
            <span class="n">_launcher</span><span class="p">,</span> <span class="n">launcher_value</span> <span class="o">=</span> <span class="n">get_game_launcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">launcher_value</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substitute</span><span class="p">(</span><span class="n">launcher_value</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;web&quot;</span><span class="p">,</span> <span class="s2">&quot;browser&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span>
                    <span class="s2">&quot;The executable at path </span><span class="si">%s</span><span class="s2"> can&#39;t be found, please check the destination folder.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s2">&quot;Some parts of the installation process may have not completed successfully.&quot;</span>
                <span class="p">)</span> <span class="o">%</span> <span class="n">path</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No executable found at specified location </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">install_complete_text</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;install_complete_text&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Installation completed!&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="n">install_complete_text</span><span class="p">)</span>
        <span class="n">download_lutris_media</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">game_slug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">on_install_finished</span><span class="p">(</span><span class="n">game_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clean up install dir after a successful install&quot;&quot;&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">))</span>
        <span class="n">system</span><span class="o">.</span><span class="n">remove_folder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">revert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_game_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Revert installation in case of an error&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Cancelling installation of </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">game_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;wine&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;winekill&quot;</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cancelled</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_current_task</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">abort_current_task</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span> <span class="ow">and</span> <span class="n">remove_game_dir</span><span class="p">:</span>
            <span class="n">system</span><span class="o">.</span><span class="n">remove_folder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_string_replacements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a mapping of variables to their actual value&quot;&quot;&quot;</span>
        <span class="n">replacements</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;GAMEDIR&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span>
            <span class="s2">&quot;CACHE&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">,</span>
            <span class="s2">&quot;HOME&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span>
            <span class="s2">&quot;STEAM_DATA_DIR&quot;</span><span class="p">:</span> <span class="n">steam</span><span class="o">.</span><span class="n">steam</span><span class="p">()</span><span class="o">.</span><span class="n">steam_data_dir</span><span class="p">,</span>
            <span class="s2">&quot;DISC&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_disc</span><span class="p">,</span>
            <span class="s2">&quot;USER&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;USER&quot;</span><span class="p">),</span>
            <span class="s2">&quot;INPUT&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_inputs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_inputs</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;VERSION&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
            <span class="s2">&quot;RESOLUTION&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_resolution</span><span class="p">),</span>
            <span class="s2">&quot;RESOLUTION_WIDTH&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_resolution</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;RESOLUTION_HEIGHT&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_resolution</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;RESOLUTION_WIDTH_HEX&quot;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_resolution</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span>
            <span class="s2">&quot;RESOLUTION_HEIGHT_HEX&quot;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_resolution</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
            <span class="s2">&quot;WINEBIN&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_wine_path</span><span class="p">(),</span>
        <span class="p">}</span>
        <span class="n">replacements</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="c1"># Add &#39;INPUT_&lt;id&gt;&#39; replacements for user inputs with an id</span>
        <span class="k">for</span> <span class="n">input_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_inputs</span><span class="p">:</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="s2">&quot;alias&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">alias</span><span class="p">:</span>
                <span class="n">replacements</span><span class="p">[</span><span class="n">alias</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
        <span class="n">replacements</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">game_files</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">replacements</span>

    <span class="k">def</span> <span class="nf">_substitute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template_string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replace path aliases with real paths.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">template_string</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No template string given&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">template_string</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_files</span><span class="p">:</span>
            <span class="n">template_string</span> <span class="o">=</span> <span class="n">template_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">system</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">template_string</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_string_replacements</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">eject_wine_disc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use Wine to eject a CD, otherwise Wine can have problems detecting disc changes&quot;&quot;&quot;</span>
        <span class="n">wine_path</span> <span class="o">=</span> <span class="n">get_wine_version_exe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_runner_version</span><span class="p">())</span>
        <span class="n">wine</span><span class="o">.</span><span class="n">eject_disc</span><span class="p">(</span><span class="n">wine_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.appid" class="doc doc-heading">
<code class="highlight language-python"><span class="n">appid</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.interpreter.ScriptInterpreter.appid" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.cache_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cache_path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.interpreter.ScriptInterpreter.cache_path" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return the directory used as a cache for the duration of the installation</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.script_env" class="doc doc-heading">
<code class="highlight language-python"><span class="n">script_env</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.interpreter.ScriptInterpreter.script_env" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return the script's own environment variable with values
susbtituted. This value can be used to provide the same environment
variable as set for the game during the install process.</p>
    </div>

  </div>






  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#lutris.installer.interpreter.ScriptInterpreter.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">installer</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">service</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">service</span> <span class="k">if</span> <span class="n">parent</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">_appid</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">appid</span> <span class="k">if</span> <span class="n">parent</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game_dir_created</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Whether a game folder was created during the install</span>
    <span class="c1"># Extra files for installers, either None if the extras haven&#39;t been checked yet.</span>
    <span class="c1"># Or a list of IDs of extras to be downloaded during the install</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">extras</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game_disc</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">game_files</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cancelled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">abort_current_task</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">user_inputs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_command</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Current installer command when iterating through them</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">runners_to_install</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">installer</span> <span class="o">=</span> <span class="n">LutrisInstaller</span><span class="p">(</span><span class="n">installer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">,</span> <span class="n">appid</span><span class="o">=</span><span class="n">_appid</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;This installer doesn&#39;t have a &#39;script&#39; section&quot;</span><span class="p">))</span>
    <span class="n">script_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">get_errors</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">script_errors</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span>
            <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid script: </span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_errors</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">current_resolution</span> <span class="o">=</span> <span class="n">DISPLAY_MANAGER</span><span class="o">.</span><span class="n">get_current_resolution</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_binary_dependencies</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_dependency</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">creates_game_folder</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_target</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.cleanup" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.cleanup" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Clean up install dir after a successful install</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Clean up install dir after a successful install&quot;&quot;&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">))</span>
    <span class="n">system</span><span class="o">.</span><span class="n">remove_folder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.create_game_folder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_game_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.create_game_folder" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Create the game folder if needed and store if is was created</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_game_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create the game folder if needed and store if is was created&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">files</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">system</span><span class="o">.</span><span class="n">path_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">creates_game_folder</span>
    <span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating destination path </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">game_dir_created</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">PermissionError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Lutris does not have the necessary permissions to install to path:&quot;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">,</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.eject_wine_disc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eject_wine_disc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.eject_wine_disc" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Use Wine to eject a CD, otherwise Wine can have problems detecting disc changes</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">eject_wine_disc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Use Wine to eject a CD, otherwise Wine can have problems detecting disc changes&quot;&quot;&quot;</span>
    <span class="n">wine_path</span> <span class="o">=</span> <span class="n">get_wine_version_exe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_runner_version</span><span class="p">())</span>
    <span class="n">wine</span><span class="o">.</span><span class="n">eject_disc</span><span class="p">(</span><span class="n">wine_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.get_default_target" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_default_target</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.get_default_target" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return default installation dir</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_default_target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return default installation dir&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">LutrisConfig</span><span class="p">(</span><span class="n">runner_slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="p">)</span>
    <span class="n">games_dir</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">system_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;game_path&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">:</span>
        <span class="n">service_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">id</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">service_dir</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">games_dir</span><span class="p">,</span> <span class="n">service_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">game_slug</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.get_extras" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_extras</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.get_extras" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Get extras and store them to move them at the end of the install</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_extras</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get extras and store them to move them at the end of the install&quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking if service provide extra files&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">has_extras</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extras</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extras</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">extras</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">get_extras</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">service_appid</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extras</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.get_runner_class" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_runner_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runner_name</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.get_runner_class" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Runner the runner class from its name</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_runner_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runner_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runner the runner class from its name&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">runner</span> <span class="o">=</span> <span class="n">import_runner</span><span class="p">(</span><span class="n">runner_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">InvalidRunner</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">GLib</span><span class="o">.</span><span class="n">idle_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">cancel_button</span><span class="o">.</span><span class="n">set_sensitive</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invalid runner provided </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">runner_name</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
    <span class="k">return</span> <span class="n">runner</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.get_runners_to_install" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_runners_to_install</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.get_runners_to_install" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Check if the runner is installed before starting the installation
Install the required runner(s) if necessary. This should handle runner
dependencies or runners used for installer tasks.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_runners_to_install</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if the runner is installed before starting the installation</span>
<span class="sd">    Install the required runner(s) if necessary. This should handle runner</span>
<span class="sd">    dependencies or runners used for installer tasks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">runners_to_install</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">required_runners</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">runner</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runner_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="p">)</span>
    <span class="n">required_runners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">runner</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;installer&quot;</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="n">command_name</span><span class="p">,</span> <span class="n">command_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_command_name_and_params</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">command_name</span> <span class="o">==</span> <span class="s2">&quot;task&quot;</span><span class="p">:</span>
            <span class="n">runner_name</span><span class="p">,</span> <span class="n">_task_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_task_runner_and_name</span><span class="p">(</span><span class="n">command_params</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
            <span class="n">runner_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">required_runners</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">runner_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">runner_names</span><span class="p">:</span>
                <span class="n">required_runners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_runner_class</span><span class="p">(</span><span class="n">runner_name</span><span class="p">)())</span>

    <span class="k">for</span> <span class="n">runner</span> <span class="ow">in</span> <span class="n">required_runners</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="o">==</span> <span class="s2">&quot;libretro&quot;</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;core&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;game&quot;</span><span class="p">][</span><span class="s2">&quot;core&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;wine&quot;</span><span class="p">):</span>
            <span class="c1"># Force the wine version to be installed</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;fallback&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;min_version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wine</span><span class="o">.</span><span class="n">MIN_SAFE_VERSION</span>
            <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_runner_version</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">version</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Looking up default wine version</span>
                <span class="n">default_wine</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">get_runner_version</span><span class="p">()</span> <span class="ow">or</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="s2">&quot;version&quot;</span> <span class="ow">in</span> <span class="n">default_wine</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Default wine version is </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">default_wine</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">])</span>
                    <span class="c1"># Set the version to both the is_installed params and</span>
                    <span class="c1"># the script itself so the version gets saved at the</span>
                    <span class="c1"># end of the install.</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">default_wine</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">],</span>
                                             <span class="n">default_wine</span><span class="p">[</span><span class="s2">&quot;architecture&quot;</span><span class="p">])</span>
                    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="p">][</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get default wine version (got </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">default_wine</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">runner</span><span class="o">.</span><span class="n">is_installed</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Runner </span><span class="si">%s</span><span class="s2"> needs to be installed&quot;</span><span class="p">,</span> <span class="n">runner</span><span class="p">)</span>
            <span class="n">runners_to_install</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">runner</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;wine&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">get_wine_version</span><span class="p">():</span>
        <span class="n">WineNotInstalledWarning</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">runners_to_install</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.install_runner" class="doc doc-heading">
<code class="highlight language-python"><span class="n">install_runner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runner</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.install_runner" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Install runner required by the install script</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">install_runner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runner</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Install runner required by the install script&quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Installing </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">runner</span><span class="o">.</span><span class="n">install</span><span class="p">(</span>
            <span class="n">version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_runner_version</span><span class="p">(),</span>
            <span class="n">downloader</span><span class="o">=</span><span class="n">simple_downloader</span><span class="p">,</span>
            <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">install_runners</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">NonInstallableRunnerError</span><span class="p">,</span> <span class="n">RunnerInstallationError</span><span class="p">)</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">message</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">ex</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.install_runners" class="doc doc-heading">
<code class="highlight language-python"><span class="n">install_runners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.install_runners" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Install required runners for a game</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">install_runners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Install required runners for a game&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runners_to_install</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">install_runner</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runners_to_install</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;runners-installed&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.launch_install" class="doc doc-heading">
<code class="highlight language-python"><span class="n">launch_install</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.launch_install" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Launch the install process</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">launch_install</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Launch the install process&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">runners_to_install</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runners_to_install</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">install_runners</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">create_game_folder</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.launch_installer_commands" class="doc doc-heading">
<code class="highlight language-python"><span class="n">launch_installer_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.launch_installer_commands" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Run the pre-installation steps and launch install.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">launch_installer_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run the pre-installation steps and launch install.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Copy extras to game folder</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extras</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">files</span><span class="p">):</span>
        <span class="c1"># Reset the install script in case there are only extras.</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Installer with only extras and no game files&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;installer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">extra</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extras</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">script</span><span class="p">[</span><span class="s2">&quot;installer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;copy&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;src&quot;</span><span class="p">:</span> <span class="n">extra</span><span class="p">,</span> <span class="s2">&quot;dst&quot;</span><span class="p">:</span> <span class="s2">&quot;$GAMEDIR/extras&quot;</span><span class="p">}}</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_iter_commands</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.interpreter.ScriptInterpreter.revert" class="doc doc-heading">
<code class="highlight language-python"><span class="n">revert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_game_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#lutris.installer.interpreter.ScriptInterpreter.revert" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Revert installation in case of an error</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/interpreter.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">revert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">remove_game_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Revert installation in case of an error&quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Cancelling installation of </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">game_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">installer</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;wine&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;winekill&quot;</span><span class="p">})</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">cancelled</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_current_task</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abort_current_task</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_path</span> <span class="ow">and</span> <span class="n">remove_game_dir</span><span class="p">:</span>
        <span class="n">system</span><span class="o">.</span><span class="n">remove_folder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_path</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="lutris.installer.legacy" class="doc doc-heading">
        <code>legacy</code>



<a href="#lutris.installer.legacy" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h3 id="lutris.installer.legacy.get_game_launcher" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_game_launcher</span><span class="p">(</span><span class="n">script</span><span class="p">)</span></code>


<a href="#lutris.installer.legacy.get_game_launcher" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return the key and value of the launcher
exe64 can be provided to specify an executable for 64bit systems
This should be deprecated when support for multiple binaries has been
added.</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/legacy.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_game_launcher</span><span class="p">(</span><span class="n">script</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the key and value of the launcher</span>
<span class="sd">    exe64 can be provided to specify an executable for 64bit systems</span>
<span class="sd">    This should be deprecated when support for multiple binaries has been</span>
<span class="sd">    added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">launcher_value</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">exe</span> <span class="o">=</span> <span class="s2">&quot;exe64&quot;</span> <span class="k">if</span> <span class="s2">&quot;exe64&quot;</span> <span class="ow">in</span> <span class="n">script</span> <span class="ow">and</span> <span class="n">linux</span><span class="o">.</span><span class="n">LINUX_SYSTEM</span><span class="o">.</span><span class="n">is_64_bit</span> <span class="k">else</span> <span class="s2">&quot;exe&quot;</span>
    <span class="k">for</span> <span class="n">launcher</span> <span class="ow">in</span> <span class="p">(</span><span class="n">exe</span><span class="p">,</span> <span class="s2">&quot;iso&quot;</span><span class="p">,</span> <span class="s2">&quot;rom&quot;</span><span class="p">,</span> <span class="s2">&quot;disk&quot;</span><span class="p">,</span> <span class="s2">&quot;main_file&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">launcher</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">script</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">launcher_value</span> <span class="o">=</span> <span class="n">script</span><span class="p">[</span><span class="n">launcher</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">launcher</span> <span class="o">==</span> <span class="s2">&quot;exe64&quot;</span><span class="p">:</span>
            <span class="n">launcher</span> <span class="o">=</span> <span class="s2">&quot;exe&quot;</span>  <span class="c1"># If exe64 is used, rename it to exe</span>
        <span class="k">break</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">launcher_value</span><span class="p">:</span>
        <span class="n">launcher</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">launcher</span><span class="p">,</span> <span class="n">launcher_value</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="lutris.installer.steam_installer" class="doc doc-heading">
        <code>steam_installer</code>



<a href="#lutris.installer.steam_installer" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Collection of installer files</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="lutris.installer.steam_installer.SteamInstaller" class="doc doc-heading">
        <code>
SteamInstaller            (<span title="gi.overrides.GObject.Object">Object</span>)
        </code>



<a href="#lutris.installer.steam_installer.SteamInstaller" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Handles installation of Steam games</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/steam_installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">SteamInstaller</span><span class="p">(</span><span class="n">GObject</span><span class="o">.</span><span class="n">Object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Handles installation of Steam games&quot;&quot;&quot;</span>

    <span class="n">__gsignals__</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;steam-game-installed&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">GObject</span><span class="o">.</span><span class="n">SIGNAL_RUN_FIRST</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">)),</span>
        <span class="s2">&quot;steam-state-changed&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">GObject</span><span class="o">.</span><span class="n">SIGNAL_RUN_FIRST</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">)),</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steam_uri</span><span class="p">,</span> <span class="n">file_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Params:</span>
<span class="sd">            steam_uri: Colon separated game info containing:</span>
<span class="sd">                    - $STEAM</span>
<span class="sd">                    - The Steam appid</span>
<span class="sd">                    - The relative path of files to retrieve</span>
<span class="sd">            file_id: The lutris installer internal id for the game files</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steam_poll</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prev_states</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Previous states for the Steam installer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">install_start_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steam_uri</span> <span class="o">=</span> <span class="n">steam_uri</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_func</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelled</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_runner</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">file_id</span> <span class="o">=</span> <span class="n">file_id</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_steam</span><span class="p">,</span> <span class="n">appid</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steam_uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Malformed steam path: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">steam_uri</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">appid</span> <span class="o">=</span> <span class="n">appid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">platform</span> <span class="o">=</span> <span class="s2">&quot;linux&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="n">steam</span><span class="o">.</span><span class="n">steam</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">steam_rel_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the relative path for data files&quot;&quot;&quot;</span>
        <span class="n">_steam_rel_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">_steam_rel_path</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
            <span class="n">_steam_rel_path</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>
        <span class="k">return</span> <span class="n">_steam_rel_path</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">on_steam_game_installed</span><span class="p">(</span><span class="n">_data</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for Steam game installer, mostly for error handling</span>
<span class="sd">        since install progress is handled by _monitor_steam_game_install</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">install_steam_game</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Launch installation of a steam game&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">get_game_path_from_appid</span><span class="p">(</span><span class="n">appid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Steam game </span><span class="si">%s</span><span class="s2"> is already installed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;steam-game-installed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Installing steam game </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">LutrisConfig</span><span class="p">(</span><span class="n">runner_slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">AsyncCall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">install_game</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_steam_game_installed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">install_start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">steam_poll</span> <span class="o">=</span> <span class="n">GLib</span><span class="o">.</span><span class="n">timeout_add</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_steam_game_install</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_func</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">remove_game_data</span><span class="p">(</span><span class="n">appid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_steam_data_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return path of Steam files&quot;&quot;&quot;</span>
        <span class="n">data_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">get_game_path_from_appid</span><span class="p">(</span><span class="n">appid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_path</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_path</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No path found for Steam game </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steam_rel_path</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_monitor_steam_game_install</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cancelled</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">states</span> <span class="o">=</span> <span class="n">get_app_state_log</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">steam_data_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">install_start_time</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">states</span> <span class="ow">and</span> <span class="n">states</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_states</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Steam installation status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">states</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;steam-state-changed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>  <span class="c1"># Broadcast new state to listeners</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prev_states</span> <span class="o">=</span> <span class="n">states</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;Fully Installed&quot;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Steam game </span><span class="si">%s</span><span class="s2"> has been installed successfully&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;steam-game-installed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 id="lutris.installer.steam_installer.SteamInstaller.steam_rel_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">steam_rel_path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

<a href="#lutris.installer.steam_installer.SteamInstaller.steam_rel_path" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return the relative path for data files</p>
    </div>

  </div>






  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.steam_installer.SteamInstaller.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steam_uri</span><span class="p">,</span> <span class="n">file_id</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#lutris.installer.steam_installer.SteamInstaller.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>steam_uri</code></td>
        <td></td>
        <td><p>Colon separated game info containing:
    - $STEAM
    - The Steam appid
    - The relative path of files to retrieve</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>file_id</code></td>
        <td></td>
        <td><p>The lutris installer internal id for the game files</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>lutris/installer/steam_installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steam_uri</span><span class="p">,</span> <span class="n">file_id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Params:</span>
<span class="sd">        steam_uri: Colon separated game info containing:</span>
<span class="sd">                - $STEAM</span>
<span class="sd">                - The Steam appid</span>
<span class="sd">                - The relative path of files to retrieve</span>
<span class="sd">        file_id: The lutris installer internal id for the game files</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">steam_poll</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prev_states</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Previous states for the Steam installer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">install_start_time</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">steam_uri</span> <span class="o">=</span> <span class="n">steam_uri</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop_func</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cancelled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_runner</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">file_id</span> <span class="o">=</span> <span class="n">file_id</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_steam</span><span class="p">,</span> <span class="n">appid</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steam_uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Malformed steam path: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">steam_uri</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">appid</span> <span class="o">=</span> <span class="n">appid</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">platform</span> <span class="o">=</span> <span class="s2">&quot;linux&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="n">steam</span><span class="o">.</span><span class="n">steam</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.steam_installer.SteamInstaller.get_steam_data_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_steam_data_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.steam_installer.SteamInstaller.get_steam_data_path" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return path of Steam files</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/steam_installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_steam_data_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return path of Steam files&quot;&quot;&quot;</span>
    <span class="n">data_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">get_game_path_from_appid</span><span class="p">(</span><span class="n">appid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_path</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_path</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No path found for Steam game </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steam_rel_path</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.steam_installer.SteamInstaller.install_steam_game" class="doc doc-heading">
<code class="highlight language-python"><span class="n">install_steam_game</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#lutris.installer.steam_installer.SteamInstaller.install_steam_game" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Launch installation of a steam game</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/steam_installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">install_steam_game</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Launch installation of a steam game&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">get_game_path_from_appid</span><span class="p">(</span><span class="n">appid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Steam game </span><span class="si">%s</span><span class="s2"> is already installed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;steam-game-installed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Installing steam game </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">LutrisConfig</span><span class="p">(</span><span class="n">runner_slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">AsyncCall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">install_game</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_steam_game_installed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">install_start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steam_poll</span> <span class="o">=</span> <span class="n">GLib</span><span class="o">.</span><span class="n">timeout_add</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_steam_game_install</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_func</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">remove_game_data</span><span class="p">(</span><span class="n">appid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">appid</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="lutris.installer.steam_installer.SteamInstaller.on_steam_game_installed" class="doc doc-heading">
<code class="highlight language-python"><span class="n">on_steam_game_installed</span><span class="p">(</span><span class="n">_data</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#lutris.installer.steam_installer.SteamInstaller.on_steam_game_installed" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Callback for Steam game installer, mostly for error handling
since install progress is handled by _monitor_steam_game_install</p>

        <details class="quote">
          <summary>Source code in <code>lutris/installer/steam_installer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">on_steam_game_installed</span><span class="p">(</span><span class="n">_data</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Callback for Steam game installer, mostly for error handling</span>
<span class="sd">    since install progress is handled by _monitor_steam_game_install</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ScriptingError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../gui/widgets/window/" class="md-footer__link md-footer__link--prev" aria-label="Previous: window" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              window
            </div>
          </div>
        </a>
      
      
        
        <a href="commands/" class="md-footer__link md-footer__link--next" aria-label="Next: commands" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              commands
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../../../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>